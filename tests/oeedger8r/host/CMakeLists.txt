# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License.
include(oeedl_file)

oeedl_file(../edl/array.edl host array)
oeedl_file(../edl/basic.edl host basic)
oeedl_file(../edl/enum.edl host enum)
oeedl_file(../edl/foreign.edl host foreign)
oeedl_file(../edl/pointer.edl host pointer)
oeedl_file(../edl/string.edl host string)
oeedl_file(../edl/struct.edl host struct)

# Custom target that depends on edge function implementations
# generated by the above command.
add_custom_target(
    run_oeedger8r_untrusted
    DEPENDS ${array} ${basic} ${enum} ${foreign} ${pointer} ${string} ${struct}
)

add_executable(edl_host 
    main.cpp
    testarray.cpp
    testbasic.cpp
    testenum.cpp
    testforeign.cpp
    testpointer.cpp
    teststring.cpp
    teststruct.cpp
)

# Make edl_enc depend on edl files and outputs using 
# the custom target.
add_dependencies(edl_host run_oeedger8r_untrusted) 

target_include_directories(edl_host PUBLIC ${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_CURRENT_SOURCE_DIR}/..)
target_compile_options(edl_host PRIVATE -std=c++11)

target_link_libraries(edl_host oehostapp)
