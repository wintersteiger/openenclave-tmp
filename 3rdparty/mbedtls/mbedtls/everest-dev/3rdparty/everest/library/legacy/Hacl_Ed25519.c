/* Copyright (c) INRIA and Microsoft Corporation. All rights reserved.
   Licensed under the Apache 2.0 License.


  This file was generated by KreMLin <https://github.com/FStarLang/kremlin>
  KreMLin invocation: /mnt/e/everest/verify/kremlin/krml -tmpdir ed25519-c89 -fc89 -header /mnt/e/everest/verify/hdr -I /mnt/e/everest/verify/hacl-star/code/old/lib/kremlin -I /mnt/e/everest/verify/kremlin/kremlib/compat -I /mnt/e/everest/verify/hacl-star/specs -I /mnt/e/everest/verify/hacl-star/specs/old -I . -fparentheses -fcurly-braces -fno-shadow -ccopt -march=native -verbose -ldopt -flto -I ../bignum -I ../curve25519 -I ../hash -bundle Hacl.Ed25519=* -minimal -add-include "kremlib.h" -skip-compilation ed25519-c/out.krml -o ed25519-c89/Hacl_Ed25519.c
  F* version: f12a8a05
  KreMLin version: d8ba3898
*/


#include "Hacl_Ed25519.h"

extern FStar_UInt128_uint128
FStar_UInt128_add(FStar_UInt128_uint128 x0, FStar_UInt128_uint128 x1);

extern FStar_UInt128_uint128
FStar_UInt128_add_mod(FStar_UInt128_uint128 x0, FStar_UInt128_uint128 x1);

extern FStar_UInt128_uint128
FStar_UInt128_logand(FStar_UInt128_uint128 x0, FStar_UInt128_uint128 x1);

extern FStar_UInt128_uint128 FStar_UInt128_shift_left(FStar_UInt128_uint128 x0, uint32_t x1);

extern FStar_UInt128_uint128 FStar_UInt128_shift_right(FStar_UInt128_uint128 x0, uint32_t x1);

extern FStar_UInt128_uint128 FStar_UInt128_uint64_to_uint128(uint64_t x0);

extern uint64_t FStar_UInt128_uint128_to_uint64(FStar_UInt128_uint128 x0);

extern FStar_UInt128_uint128 FStar_UInt128_mul_wide(uint64_t x0, uint64_t x1);

extern uint64_t FStar_UInt64_eq_mask(uint64_t x0, uint64_t x1);

extern uint64_t FStar_UInt64_gte_mask(uint64_t x0, uint64_t x1);

inline static void
Hacl_Bignum_Fproduct_copy_from_wide_(uint64_t *output, FStar_UInt128_uint128 *input)
{
  uint32_t i;
  for (i = (uint32_t)0U; i < (uint32_t)5U; i = i + (uint32_t)1U)
  {
    FStar_UInt128_uint128 xi = input[i];
    output[i] = FStar_UInt128_uint128_to_uint64(xi);
  }
}

inline static void
Hacl_Bignum_Fproduct_sum_scalar_multiplication_(
  FStar_UInt128_uint128 *output,
  uint64_t *input,
  uint64_t s
)
{
  uint32_t i;
  for (i = (uint32_t)0U; i < (uint32_t)5U; i = i + (uint32_t)1U)
  {
    FStar_UInt128_uint128 xi = output[i];
    uint64_t yi = input[i];
    output[i] = FStar_UInt128_add_mod(xi, FStar_UInt128_mul_wide(yi, s));
  }
}

inline static void Hacl_Bignum_Fproduct_carry_wide_(FStar_UInt128_uint128 *tmp)
{
  uint32_t i;
  for (i = (uint32_t)0U; i < (uint32_t)4U; i = i + (uint32_t)1U)
  {
    uint32_t ctr = i;
    FStar_UInt128_uint128 tctr = tmp[ctr];
    FStar_UInt128_uint128 tctrp1 = tmp[ctr + (uint32_t)1U];
    uint64_t r0 = FStar_UInt128_uint128_to_uint64(tctr) & (uint64_t)0x7ffffffffffffU;
    FStar_UInt128_uint128 c = FStar_UInt128_shift_right(tctr, (uint32_t)51U);
    tmp[ctr] = FStar_UInt128_uint64_to_uint128(r0);
    tmp[ctr + (uint32_t)1U] = FStar_UInt128_add(tctrp1, c);
  }
}

static void Hacl_Bignum_Modulo_carry_top(uint64_t *b)
{
  uint64_t b4 = b[4U];
  uint64_t b0 = b[0U];
  uint64_t b4_ = b4 & (uint64_t)0x7ffffffffffffU;
  uint64_t b0_ = b0 + (uint64_t)19U * (b4 >> (uint32_t)51U);
  b[4U] = b4_;
  b[0U] = b0_;
}

inline static void Hacl_Bignum_Fmul_shift_reduce(uint64_t *output)
{
  uint64_t tmp = output[4U];
  uint64_t b0;
  {
    uint32_t i;
    for (i = (uint32_t)0U; i < (uint32_t)4U; i = i + (uint32_t)1U)
    {
      uint32_t ctr = (uint32_t)5U - i - (uint32_t)1U;
      uint64_t z = output[ctr - (uint32_t)1U];
      output[ctr] = z;
    }
  }
  output[0U] = tmp;
  b0 = output[0U];
  output[0U] = (uint64_t)19U * b0;
}

static void
Hacl_Bignum_Fmul_mul_shift_reduce_(
  FStar_UInt128_uint128 *output,
  uint64_t *input,
  uint64_t *input21
)
{
  uint32_t i;
  uint64_t input2i;
  {
    uint32_t i0;
    for (i0 = (uint32_t)0U; i0 < (uint32_t)4U; i0 = i0 + (uint32_t)1U)
    {
      uint64_t input2i0 = input21[i0];
      Hacl_Bignum_Fproduct_sum_scalar_multiplication_(output, input, input2i0);
      Hacl_Bignum_Fmul_shift_reduce(input);
    }
  }
  i = (uint32_t)4U;
  input2i = input21[i];
  Hacl_Bignum_Fproduct_sum_scalar_multiplication_(output, input, input2i);
}

inline static void Hacl_Bignum_Fmul_fmul(uint64_t *output, uint64_t *input, uint64_t *input21)
{
  uint64_t tmp[5U] = { 0U };
  memcpy(tmp, input, (uint32_t)5U * sizeof input[0U]);
  KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)5U);
  {
    FStar_UInt128_uint128 t[5U];
    {
      uint32_t _i;
      for (_i = 0U; _i < (uint32_t)5U; ++_i)
        t[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
    }
    {
      FStar_UInt128_uint128 b4;
      FStar_UInt128_uint128 b0;
      FStar_UInt128_uint128 b4_;
      FStar_UInt128_uint128 b0_;
      uint64_t i0;
      uint64_t i1;
      uint64_t i0_;
      uint64_t i1_;
      Hacl_Bignum_Fmul_mul_shift_reduce_(t, tmp, input21);
      Hacl_Bignum_Fproduct_carry_wide_(t);
      b4 = t[4U];
      b0 = t[0U];
      b4_ = FStar_UInt128_logand(b4, FStar_UInt128_uint64_to_uint128((uint64_t)0x7ffffffffffffU));
      b0_ =
        FStar_UInt128_add(b0,
          FStar_UInt128_mul_wide((uint64_t)19U,
            FStar_UInt128_uint128_to_uint64(FStar_UInt128_shift_right(b4, (uint32_t)51U))));
      t[4U] = b4_;
      t[0U] = b0_;
      Hacl_Bignum_Fproduct_copy_from_wide_(output, t);
      i0 = output[0U];
      i1 = output[1U];
      i0_ = i0 & (uint64_t)0x7ffffffffffffU;
      i1_ = i1 + (i0 >> (uint32_t)51U);
      output[0U] = i0_;
      output[1U] = i1_;
    }
  }
}

inline static void Hacl_Bignum_Fsquare_fsquare__(FStar_UInt128_uint128 *tmp, uint64_t *output)
{
  uint64_t r0 = output[0U];
  uint64_t r1 = output[1U];
  uint64_t r2 = output[2U];
  uint64_t r3 = output[3U];
  uint64_t r4 = output[4U];
  uint64_t d0 = r0 * (uint64_t)2U;
  uint64_t d1 = r1 * (uint64_t)2U;
  uint64_t d2 = r2 * (uint64_t)2U * (uint64_t)19U;
  uint64_t d419 = r4 * (uint64_t)19U;
  uint64_t d4 = d419 * (uint64_t)2U;
  FStar_UInt128_uint128
  s0 =
    FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_mul_wide(r0, r0),
        FStar_UInt128_mul_wide(d4, r1)),
      FStar_UInt128_mul_wide(d2, r3));
  FStar_UInt128_uint128
  s1 =
    FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_mul_wide(d0, r1),
        FStar_UInt128_mul_wide(d4, r2)),
      FStar_UInt128_mul_wide(r3 * (uint64_t)19U, r3));
  FStar_UInt128_uint128
  s2 =
    FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_mul_wide(d0, r2),
        FStar_UInt128_mul_wide(r1, r1)),
      FStar_UInt128_mul_wide(d4, r3));
  FStar_UInt128_uint128
  s3 =
    FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_mul_wide(d0, r3),
        FStar_UInt128_mul_wide(d1, r2)),
      FStar_UInt128_mul_wide(r4, d419));
  FStar_UInt128_uint128
  s4 =
    FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_mul_wide(d0, r4),
        FStar_UInt128_mul_wide(d1, r3)),
      FStar_UInt128_mul_wide(r2, r2));
  tmp[0U] = s0;
  tmp[1U] = s1;
  tmp[2U] = s2;
  tmp[3U] = s3;
  tmp[4U] = s4;
}

inline static void Hacl_Bignum_Fsquare_fsquare_(FStar_UInt128_uint128 *tmp, uint64_t *output)
{
  FStar_UInt128_uint128 b4;
  FStar_UInt128_uint128 b0;
  FStar_UInt128_uint128 b4_;
  FStar_UInt128_uint128 b0_;
  uint64_t i0;
  uint64_t i1;
  uint64_t i0_;
  uint64_t i1_;
  Hacl_Bignum_Fsquare_fsquare__(tmp, output);
  Hacl_Bignum_Fproduct_carry_wide_(tmp);
  b4 = tmp[4U];
  b0 = tmp[0U];
  b4_ = FStar_UInt128_logand(b4, FStar_UInt128_uint64_to_uint128((uint64_t)0x7ffffffffffffU));
  b0_ =
    FStar_UInt128_add(b0,
      FStar_UInt128_mul_wide((uint64_t)19U,
        FStar_UInt128_uint128_to_uint64(FStar_UInt128_shift_right(b4, (uint32_t)51U))));
  tmp[4U] = b4_;
  tmp[0U] = b0_;
  Hacl_Bignum_Fproduct_copy_from_wide_(output, tmp);
  i0 = output[0U];
  i1 = output[1U];
  i0_ = i0 & (uint64_t)0x7ffffffffffffU;
  i1_ = i1 + (i0 >> (uint32_t)51U);
  output[0U] = i0_;
  output[1U] = i1_;
}

static void
Hacl_Bignum_Fsquare_fsquare_times_(
  uint64_t *input,
  FStar_UInt128_uint128 *tmp,
  uint32_t count1
)
{
  uint32_t i;
  Hacl_Bignum_Fsquare_fsquare_(tmp, input);
  for (i = (uint32_t)1U; i < count1; i = i + (uint32_t)1U)
  {
    Hacl_Bignum_Fsquare_fsquare_(tmp, input);
  }
}

inline static void
Hacl_Bignum_Fsquare_fsquare_times(uint64_t *output, uint64_t *input, uint32_t count1)
{
  KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)5U);
  {
    FStar_UInt128_uint128 t[5U];
    {
      uint32_t _i;
      for (_i = 0U; _i < (uint32_t)5U; ++_i)
        t[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
    }
    memcpy(output, input, (uint32_t)5U * sizeof input[0U]);
    Hacl_Bignum_Fsquare_fsquare_times_(output, t, count1);
  }
}

inline static void Hacl_Bignum_Fsquare_fsquare_times_inplace(uint64_t *output, uint32_t count1)
{
  KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)5U);
  {
    FStar_UInt128_uint128 t[5U];
    {
      uint32_t _i;
      for (_i = 0U; _i < (uint32_t)5U; ++_i)
        t[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
    }
    Hacl_Bignum_Fsquare_fsquare_times_(output, t, count1);
  }
}

inline static void Hacl_Bignum_Crecip_crecip(uint64_t *out, uint64_t *z)
{
  uint64_t buf[20U] = { 0U };
  uint64_t *a0 = buf;
  uint64_t *t00 = buf + (uint32_t)5U;
  uint64_t *b0 = buf + (uint32_t)10U;
  uint64_t *t01;
  uint64_t *b1;
  uint64_t *c0;
  uint64_t *a;
  uint64_t *t0;
  uint64_t *b;
  uint64_t *c;
  Hacl_Bignum_Fsquare_fsquare_times(a0, z, (uint32_t)1U);
  Hacl_Bignum_Fsquare_fsquare_times(t00, a0, (uint32_t)2U);
  Hacl_Bignum_Fmul_fmul(b0, t00, z);
  Hacl_Bignum_Fmul_fmul(a0, b0, a0);
  Hacl_Bignum_Fsquare_fsquare_times(t00, a0, (uint32_t)1U);
  Hacl_Bignum_Fmul_fmul(b0, t00, b0);
  Hacl_Bignum_Fsquare_fsquare_times(t00, b0, (uint32_t)5U);
  t01 = buf + (uint32_t)5U;
  b1 = buf + (uint32_t)10U;
  c0 = buf + (uint32_t)15U;
  Hacl_Bignum_Fmul_fmul(b1, t01, b1);
  Hacl_Bignum_Fsquare_fsquare_times(t01, b1, (uint32_t)10U);
  Hacl_Bignum_Fmul_fmul(c0, t01, b1);
  Hacl_Bignum_Fsquare_fsquare_times(t01, c0, (uint32_t)20U);
  Hacl_Bignum_Fmul_fmul(t01, t01, c0);
  Hacl_Bignum_Fsquare_fsquare_times_inplace(t01, (uint32_t)10U);
  Hacl_Bignum_Fmul_fmul(b1, t01, b1);
  Hacl_Bignum_Fsquare_fsquare_times(t01, b1, (uint32_t)50U);
  a = buf;
  t0 = buf + (uint32_t)5U;
  b = buf + (uint32_t)10U;
  c = buf + (uint32_t)15U;
  Hacl_Bignum_Fmul_fmul(c, t0, b);
  Hacl_Bignum_Fsquare_fsquare_times(t0, c, (uint32_t)100U);
  Hacl_Bignum_Fmul_fmul(t0, t0, c);
  Hacl_Bignum_Fsquare_fsquare_times_inplace(t0, (uint32_t)50U);
  Hacl_Bignum_Fmul_fmul(t0, t0, b);
  Hacl_Bignum_Fsquare_fsquare_times_inplace(t0, (uint32_t)5U);
  Hacl_Bignum_Fmul_fmul(out, t0, a);
}

inline static void Hacl_Bignum_Crecip_crecip_(uint64_t *out, uint64_t *z)
{
  uint64_t buf[20U] = { 0U };
  uint64_t *a0 = buf;
  uint64_t *t00 = buf + (uint32_t)5U;
  uint64_t *b0 = buf + (uint32_t)10U;
  uint64_t *t01;
  uint64_t *b1;
  uint64_t *c0;
  uint64_t *a1;
  uint64_t *a;
  uint64_t *t0;
  uint64_t *b;
  uint64_t *c;
  Hacl_Bignum_Fsquare_fsquare_times(a0, z, (uint32_t)1U);
  Hacl_Bignum_Fsquare_fsquare_times(t00, a0, (uint32_t)2U);
  Hacl_Bignum_Fmul_fmul(b0, t00, z);
  Hacl_Bignum_Fmul_fmul(a0, b0, a0);
  Hacl_Bignum_Fsquare_fsquare_times(t00, a0, (uint32_t)1U);
  Hacl_Bignum_Fmul_fmul(b0, t00, b0);
  Hacl_Bignum_Fsquare_fsquare_times(t00, b0, (uint32_t)5U);
  t01 = buf + (uint32_t)5U;
  b1 = buf + (uint32_t)10U;
  c0 = buf + (uint32_t)15U;
  Hacl_Bignum_Fmul_fmul(b1, t01, b1);
  Hacl_Bignum_Fsquare_fsquare_times(t01, b1, (uint32_t)10U);
  Hacl_Bignum_Fmul_fmul(c0, t01, b1);
  Hacl_Bignum_Fsquare_fsquare_times(t01, c0, (uint32_t)20U);
  Hacl_Bignum_Fmul_fmul(t01, t01, c0);
  Hacl_Bignum_Fsquare_fsquare_times_inplace(t01, (uint32_t)10U);
  Hacl_Bignum_Fmul_fmul(b1, t01, b1);
  Hacl_Bignum_Fsquare_fsquare_times(t01, b1, (uint32_t)50U);
  a1 = buf;
  Hacl_Bignum_Fsquare_fsquare_times(a1, z, (uint32_t)1U);
  a = buf;
  t0 = buf + (uint32_t)5U;
  b = buf + (uint32_t)10U;
  c = buf + (uint32_t)15U;
  Hacl_Bignum_Fmul_fmul(c, t0, b);
  Hacl_Bignum_Fsquare_fsquare_times(t0, c, (uint32_t)100U);
  Hacl_Bignum_Fmul_fmul(t0, t0, c);
  Hacl_Bignum_Fsquare_fsquare_times_inplace(t0, (uint32_t)50U);
  Hacl_Bignum_Fmul_fmul(t0, t0, b);
  Hacl_Bignum_Fsquare_fsquare_times_inplace(t0, (uint32_t)2U);
  Hacl_Bignum_Fmul_fmul(out, t0, a);
}

inline static void Hacl_Bignum_fsum(uint64_t *a, uint64_t *b)
{
  uint32_t i;
  for (i = (uint32_t)0U; i < (uint32_t)5U; i = i + (uint32_t)1U)
  {
    uint64_t xi = a[i];
    uint64_t yi = b[i];
    a[i] = xi + yi;
  }
}

inline static void Hacl_Bignum_fdifference(uint64_t *a, uint64_t *b)
{
  uint64_t tmp[5U] = { 0U };
  uint64_t b0;
  uint64_t b1;
  uint64_t b2;
  uint64_t b3;
  uint64_t b4;
  memcpy(tmp, b, (uint32_t)5U * sizeof b[0U]);
  b0 = tmp[0U];
  b1 = tmp[1U];
  b2 = tmp[2U];
  b3 = tmp[3U];
  b4 = tmp[4U];
  tmp[0U] = b0 + (uint64_t)0x3fffffffffff68U;
  tmp[1U] = b1 + (uint64_t)0x3ffffffffffff8U;
  tmp[2U] = b2 + (uint64_t)0x3ffffffffffff8U;
  tmp[3U] = b3 + (uint64_t)0x3ffffffffffff8U;
  tmp[4U] = b4 + (uint64_t)0x3ffffffffffff8U;
  {
    uint32_t i;
    for (i = (uint32_t)0U; i < (uint32_t)5U; i = i + (uint32_t)1U)
    {
      uint64_t xi = a[i];
      uint64_t yi = tmp[i];
      a[i] = yi - xi;
    }
  }
}

inline static void Hacl_Bignum_fmul(uint64_t *output, uint64_t *a, uint64_t *b)
{
  Hacl_Bignum_Fmul_fmul(output, a, b);
}

extern void store128_be(uint8_t *x0, FStar_UInt128_uint128 x1);

static void Hacl_EC_Format_fexpand(uint64_t *output, uint8_t *input)
{
  uint64_t i0 = load64_le(input);
  uint8_t *x00 = input + (uint32_t)6U;
  uint64_t i1 = load64_le(x00);
  uint8_t *x01 = input + (uint32_t)12U;
  uint64_t i2 = load64_le(x01);
  uint8_t *x02 = input + (uint32_t)19U;
  uint64_t i3 = load64_le(x02);
  uint8_t *x0 = input + (uint32_t)24U;
  uint64_t i4 = load64_le(x0);
  uint64_t output0 = i0 & (uint64_t)0x7ffffffffffffU;
  uint64_t output1 = i1 >> (uint32_t)3U & (uint64_t)0x7ffffffffffffU;
  uint64_t output2 = i2 >> (uint32_t)6U & (uint64_t)0x7ffffffffffffU;
  uint64_t output3 = i3 >> (uint32_t)1U & (uint64_t)0x7ffffffffffffU;
  uint64_t output4 = i4 >> (uint32_t)12U & (uint64_t)0x7ffffffffffffU;
  output[0U] = output0;
  output[1U] = output1;
  output[2U] = output2;
  output[3U] = output3;
  output[4U] = output4;
}

static void Hacl_EC_Format_fcontract_first_carry_pass(uint64_t *input)
{
  uint64_t t0 = input[0U];
  uint64_t t1 = input[1U];
  uint64_t t2 = input[2U];
  uint64_t t3 = input[3U];
  uint64_t t4 = input[4U];
  uint64_t t1_ = t1 + (t0 >> (uint32_t)51U);
  uint64_t t0_ = t0 & (uint64_t)0x7ffffffffffffU;
  uint64_t t2_ = t2 + (t1_ >> (uint32_t)51U);
  uint64_t t1__ = t1_ & (uint64_t)0x7ffffffffffffU;
  uint64_t t3_ = t3 + (t2_ >> (uint32_t)51U);
  uint64_t t2__ = t2_ & (uint64_t)0x7ffffffffffffU;
  uint64_t t4_ = t4 + (t3_ >> (uint32_t)51U);
  uint64_t t3__ = t3_ & (uint64_t)0x7ffffffffffffU;
  input[0U] = t0_;
  input[1U] = t1__;
  input[2U] = t2__;
  input[3U] = t3__;
  input[4U] = t4_;
}

static void Hacl_EC_Format_fcontract_first_carry_full(uint64_t *input)
{
  Hacl_EC_Format_fcontract_first_carry_pass(input);
  Hacl_Bignum_Modulo_carry_top(input);
}

static void Hacl_EC_Format_fcontract_second_carry_pass(uint64_t *input)
{
  uint64_t t0 = input[0U];
  uint64_t t1 = input[1U];
  uint64_t t2 = input[2U];
  uint64_t t3 = input[3U];
  uint64_t t4 = input[4U];
  uint64_t t1_ = t1 + (t0 >> (uint32_t)51U);
  uint64_t t0_ = t0 & (uint64_t)0x7ffffffffffffU;
  uint64_t t2_ = t2 + (t1_ >> (uint32_t)51U);
  uint64_t t1__ = t1_ & (uint64_t)0x7ffffffffffffU;
  uint64_t t3_ = t3 + (t2_ >> (uint32_t)51U);
  uint64_t t2__ = t2_ & (uint64_t)0x7ffffffffffffU;
  uint64_t t4_ = t4 + (t3_ >> (uint32_t)51U);
  uint64_t t3__ = t3_ & (uint64_t)0x7ffffffffffffU;
  input[0U] = t0_;
  input[1U] = t1__;
  input[2U] = t2__;
  input[3U] = t3__;
  input[4U] = t4_;
}

static void Hacl_EC_Format_fcontract_second_carry_full(uint64_t *input)
{
  uint64_t i0;
  uint64_t i1;
  uint64_t i0_;
  uint64_t i1_;
  Hacl_EC_Format_fcontract_second_carry_pass(input);
  Hacl_Bignum_Modulo_carry_top(input);
  i0 = input[0U];
  i1 = input[1U];
  i0_ = i0 & (uint64_t)0x7ffffffffffffU;
  i1_ = i1 + (i0 >> (uint32_t)51U);
  input[0U] = i0_;
  input[1U] = i1_;
}

static void Hacl_EC_Format_fcontract_trim(uint64_t *input)
{
  uint64_t a0 = input[0U];
  uint64_t a1 = input[1U];
  uint64_t a2 = input[2U];
  uint64_t a3 = input[3U];
  uint64_t a4 = input[4U];
  uint64_t mask0 = FStar_UInt64_gte_mask(a0, (uint64_t)0x7ffffffffffedU);
  uint64_t mask1 = FStar_UInt64_eq_mask(a1, (uint64_t)0x7ffffffffffffU);
  uint64_t mask2 = FStar_UInt64_eq_mask(a2, (uint64_t)0x7ffffffffffffU);
  uint64_t mask3 = FStar_UInt64_eq_mask(a3, (uint64_t)0x7ffffffffffffU);
  uint64_t mask4 = FStar_UInt64_eq_mask(a4, (uint64_t)0x7ffffffffffffU);
  uint64_t mask = (((mask0 & mask1) & mask2) & mask3) & mask4;
  uint64_t a0_ = a0 - ((uint64_t)0x7ffffffffffedU & mask);
  uint64_t a1_ = a1 - ((uint64_t)0x7ffffffffffffU & mask);
  uint64_t a2_ = a2 - ((uint64_t)0x7ffffffffffffU & mask);
  uint64_t a3_ = a3 - ((uint64_t)0x7ffffffffffffU & mask);
  uint64_t a4_ = a4 - ((uint64_t)0x7ffffffffffffU & mask);
  input[0U] = a0_;
  input[1U] = a1_;
  input[2U] = a2_;
  input[3U] = a3_;
  input[4U] = a4_;
}

static void Hacl_EC_Format_reduce(uint64_t *out)
{
  Hacl_EC_Format_fcontract_first_carry_full(out);
  Hacl_EC_Format_fcontract_second_carry_full(out);
  Hacl_EC_Format_fcontract_trim(out);
}

static void Hacl_EC_Format_fcontract_store(uint8_t *output, uint64_t *input)
{
  uint64_t t0 = input[0U];
  uint64_t t1 = input[1U];
  uint64_t t2 = input[2U];
  uint64_t t3 = input[3U];
  uint64_t t4 = input[4U];
  uint64_t o0 = t1 << (uint32_t)51U | t0;
  uint64_t o1 = t2 << (uint32_t)38U | t1 >> (uint32_t)13U;
  uint64_t o2 = t3 << (uint32_t)25U | t2 >> (uint32_t)26U;
  uint64_t o3 = t4 << (uint32_t)12U | t3 >> (uint32_t)39U;
  uint8_t *b0 = output;
  uint8_t *b1 = output + (uint32_t)8U;
  uint8_t *b2 = output + (uint32_t)16U;
  uint8_t *b3 = output + (uint32_t)24U;
  store64_le(b0, o0);
  store64_le(b1, o1);
  store64_le(b2, o2);
  store64_le(b3, o3);
}

static bool Hacl_Impl_Ed25519_RecoverX_is_0(uint64_t *x)
{
  uint64_t x0 = x[0U];
  uint64_t x1 = x[1U];
  uint64_t x2 = x[2U];
  uint64_t x3 = x[3U];
  uint64_t x4 = x[4U];
  return
    x0
    == (uint64_t)0U
    && x1 == (uint64_t)0U
    && x2 == (uint64_t)0U
    && x3 == (uint64_t)0U
    && x4 == (uint64_t)0U;
}

static bool Hacl_Impl_Ed25519_RecoverX_recover_x(uint64_t *x, uint64_t *y, uint64_t sign1)
{
  uint64_t tmp[20U] = { 0U };
  uint64_t *x2 = tmp;
  uint64_t x00 = y[0U];
  uint64_t x1 = y[1U];
  uint64_t x210 = y[2U];
  uint64_t x30 = y[3U];
  uint64_t x4 = y[4U];
  bool
  b =
    x00
    >= (uint64_t)0x7ffffffffffedU
    && x1 == (uint64_t)0x7ffffffffffffU
    && x210 == (uint64_t)0x7ffffffffffffU
    && x30 == (uint64_t)0x7ffffffffffffU
    && x4 == (uint64_t)0x7ffffffffffffU;
  bool res;
  if (b)
  {
    res = false;
  }
  else
  {
    uint64_t tmp10[25U] = { 0U };
    uint64_t *one1 = tmp10;
    uint64_t *y2 = tmp10 + (uint32_t)5U;
    uint64_t *dyyi = tmp10 + (uint32_t)10U;
    uint64_t *dyy = tmp10 + (uint32_t)15U;
    uint64_t zero10 = (uint64_t)0U;
    uint64_t one2 = (uint64_t)1U;
    one1[0U] = one2;
    one1[1U] = zero10;
    one1[2U] = zero10;
    one1[3U] = zero10;
    one1[4U] = zero10;
    KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)5U);
    {
      FStar_UInt128_uint128 tmp2[5U];
      {
        uint32_t _i;
        for (_i = 0U; _i < (uint32_t)5U; ++_i)
          tmp2[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
      }
      memcpy(y2, y, (uint32_t)5U * sizeof y[0U]);
      Hacl_Bignum_Fsquare_fsquare_(tmp2, y2);
      {
        uint64_t d1[5U] = { 0U };
        d1[0U] = (uint64_t)0x00034dca135978a3U;
        d1[1U] = (uint64_t)0x0001a8283b156ebdU;
        d1[2U] = (uint64_t)0x0005e7a26001c029U;
        d1[3U] = (uint64_t)0x000739c663a03cbbU;
        d1[4U] = (uint64_t)0x00052036cee2b6ffU;
        Hacl_Bignum_fmul(dyy, d1, y2);
        Hacl_Bignum_fsum(dyy, one1);
        {
          uint64_t t00 = dyy[0U];
          uint64_t t10 = dyy[1U];
          uint64_t t20 = dyy[2U];
          uint64_t t30 = dyy[3U];
          uint64_t t40 = dyy[4U];
          uint64_t t1_ = t10 + (t00 >> (uint32_t)51U);
          uint64_t t0_ = t00 & (uint64_t)0x7ffffffffffffU;
          uint64_t t2_ = t20 + (t1_ >> (uint32_t)51U);
          uint64_t t1__ = t1_ & (uint64_t)0x7ffffffffffffU;
          uint64_t t3_ = t30 + (t2_ >> (uint32_t)51U);
          uint64_t t2__ = t2_ & (uint64_t)0x7ffffffffffffU;
          uint64_t t4_ = t40 + (t3_ >> (uint32_t)51U);
          uint64_t t3__ = t3_ & (uint64_t)0x7ffffffffffffU;
          dyy[0U] = t0_;
          dyy[1U] = t1__;
          dyy[2U] = t2__;
          dyy[3U] = t3__;
          dyy[4U] = t4_;
          Hacl_Bignum_Modulo_carry_top(dyy);
          {
            uint64_t i0 = dyy[0U];
            uint64_t i10 = dyy[1U];
            uint64_t i0_ = i0 & (uint64_t)0x7ffffffffffffU;
            uint64_t i1_ = i10 + (i0 >> (uint32_t)51U);
            dyy[0U] = i0_;
            dyy[1U] = i1_;
            Hacl_Bignum_Crecip_crecip(dyyi, dyy);
            Hacl_Bignum_fdifference(one1, y2);
            Hacl_Bignum_fmul(x2, dyyi, one1);
            Hacl_EC_Format_reduce(x2);
            {
              bool x2_is_0 = Hacl_Impl_Ed25519_RecoverX_is_0(x2);
              uint8_t z;
              if (x2_is_0)
              {
                uint8_t ite;
                if (sign1 == (uint64_t)0U)
                {
                  uint64_t zero1 = (uint64_t)0U;
                  x[0U] = zero1;
                  x[1U] = zero1;
                  x[2U] = zero1;
                  x[3U] = zero1;
                  x[4U] = zero1;
                  ite = (uint8_t)1U;
                }
                else
                {
                  ite = (uint8_t)0U;
                }
                z = ite;
              }
              else
              {
                z = (uint8_t)2U;
              }
              {
                bool ite0;
                if (z == (uint8_t)0U)
                {
                  ite0 = false;
                }
                else
                {
                  bool ite1;
                  if (z == (uint8_t)1U)
                  {
                    ite1 = true;
                  }
                  else
                  {
                    uint64_t *x21 = tmp;
                    uint64_t *x31 = tmp + (uint32_t)5U;
                    uint64_t *t01 = tmp + (uint32_t)10U;
                    uint64_t *t12 = tmp + (uint32_t)15U;
                    Hacl_Bignum_Crecip_crecip_(x31, x21);
                    KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)5U);
                    {
                      FStar_UInt128_uint128 tmp11[5U];
                      {
                        uint32_t _i;
                        for (_i = 0U; _i < (uint32_t)5U; ++_i)
                          tmp11[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
                      }
                      memcpy(t01, x31, (uint32_t)5U * sizeof x31[0U]);
                      Hacl_Bignum_Fsquare_fsquare_(tmp11, t01);
                      memcpy(t12, x21, (uint32_t)5U * sizeof x21[0U]);
                      Hacl_Bignum_fdifference(t12, t01);
                      {
                        uint64_t t010 = t12[0U];
                        uint64_t t110 = t12[1U];
                        uint64_t t21 = t12[2U];
                        uint64_t t31 = t12[3U];
                        uint64_t t41 = t12[4U];
                        uint64_t t1_0 = t110 + (t010 >> (uint32_t)51U);
                        uint64_t t0_0 = t010 & (uint64_t)0x7ffffffffffffU;
                        uint64_t t2_0 = t21 + (t1_0 >> (uint32_t)51U);
                        uint64_t t1__0 = t1_0 & (uint64_t)0x7ffffffffffffU;
                        uint64_t t3_0 = t31 + (t2_0 >> (uint32_t)51U);
                        uint64_t t2__0 = t2_0 & (uint64_t)0x7ffffffffffffU;
                        uint64_t t4_0 = t41 + (t3_0 >> (uint32_t)51U);
                        uint64_t t3__0 = t3_0 & (uint64_t)0x7ffffffffffffU;
                        t12[0U] = t0_0;
                        t12[1U] = t1__0;
                        t12[2U] = t2__0;
                        t12[3U] = t3__0;
                        t12[4U] = t4_0;
                        Hacl_Bignum_Modulo_carry_top(t12);
                        {
                          uint64_t i00 = t12[0U];
                          uint64_t i11 = t12[1U];
                          uint64_t i0_0 = i00 & (uint64_t)0x7ffffffffffffU;
                          uint64_t i1_0 = i11 + (i00 >> (uint32_t)51U);
                          t12[0U] = i0_0;
                          t12[1U] = i1_0;
                          Hacl_EC_Format_reduce(t12);
                          {
                            bool t1_is_0 = Hacl_Impl_Ed25519_RecoverX_is_0(t12);
                            if (!t1_is_0)
                            {
                              uint64_t sqrt_m1[5U] = { 0U };
                              sqrt_m1[0U] = (uint64_t)0x00061b274a0ea0b0U;
                              sqrt_m1[1U] = (uint64_t)0x0000d5a5fc8f189dU;
                              sqrt_m1[2U] = (uint64_t)0x0007ef5e9cbd0c60U;
                              sqrt_m1[3U] = (uint64_t)0x00078595a6804c9eU;
                              sqrt_m1[4U] = (uint64_t)0x0002b8324804fc1dU;
                              Hacl_Bignum_fmul(x31, x31, sqrt_m1);
                            }
                            Hacl_EC_Format_reduce(x31);
                            {
                              uint64_t *x211 = tmp;
                              uint64_t *x32 = tmp + (uint32_t)5U;
                              uint64_t *t02 = tmp + (uint32_t)10U;
                              uint64_t *t13 = tmp + (uint32_t)15U;
                              KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)5U);
                              {
                                FStar_UInt128_uint128 tmp1[5U];
                                {
                                  uint32_t _i;
                                  for (_i = 0U; _i < (uint32_t)5U; ++_i)
                                    tmp1[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
                                }
                                memcpy(t02, x32, (uint32_t)5U * sizeof x32[0U]);
                                Hacl_Bignum_Fsquare_fsquare_(tmp1, t02);
                                memcpy(t13, x211, (uint32_t)5U * sizeof x211[0U]);
                                Hacl_Bignum_fdifference(t13, t02);
                                {
                                  uint64_t t011 = t13[0U];
                                  uint64_t t11 = t13[1U];
                                  uint64_t t22 = t13[2U];
                                  uint64_t t32 = t13[3U];
                                  uint64_t t42 = t13[4U];
                                  uint64_t t1_1 = t11 + (t011 >> (uint32_t)51U);
                                  uint64_t t0_1 = t011 & (uint64_t)0x7ffffffffffffU;
                                  uint64_t t2_1 = t22 + (t1_1 >> (uint32_t)51U);
                                  uint64_t t1__1 = t1_1 & (uint64_t)0x7ffffffffffffU;
                                  uint64_t t3_1 = t32 + (t2_1 >> (uint32_t)51U);
                                  uint64_t t2__1 = t2_1 & (uint64_t)0x7ffffffffffffU;
                                  uint64_t t4_1 = t42 + (t3_1 >> (uint32_t)51U);
                                  uint64_t t3__1 = t3_1 & (uint64_t)0x7ffffffffffffU;
                                  t13[0U] = t0_1;
                                  t13[1U] = t1__1;
                                  t13[2U] = t2__1;
                                  t13[3U] = t3__1;
                                  t13[4U] = t4_1;
                                  Hacl_Bignum_Modulo_carry_top(t13);
                                  {
                                    uint64_t i01 = t13[0U];
                                    uint64_t i12 = t13[1U];
                                    uint64_t i0_1 = i01 & (uint64_t)0x7ffffffffffffU;
                                    uint64_t i1_1 = i12 + (i01 >> (uint32_t)51U);
                                    t13[0U] = i0_1;
                                    t13[1U] = i1_1;
                                    Hacl_EC_Format_reduce(t13);
                                    {
                                      bool z1 = Hacl_Impl_Ed25519_RecoverX_is_0(t13);
                                      bool ite;
                                      if (z1 == false)
                                      {
                                        ite = false;
                                      }
                                      else
                                      {
                                        uint64_t *x3 = tmp + (uint32_t)5U;
                                        uint64_t *t0 = tmp + (uint32_t)10U;
                                        uint64_t x0 = x3[0U];
                                        uint64_t x01 = x0 & (uint64_t)1U;
                                        if (!(x01 == sign1))
                                        {
                                          uint64_t zero1 = (uint64_t)0U;
                                          t0[0U] = zero1;
                                          t0[1U] = zero1;
                                          t0[2U] = zero1;
                                          t0[3U] = zero1;
                                          t0[4U] = zero1;
                                          Hacl_Bignum_fdifference(x3, t0);
                                          {
                                            uint64_t t012 = x3[0U];
                                            uint64_t t1 = x3[1U];
                                            uint64_t t2 = x3[2U];
                                            uint64_t t3 = x3[3U];
                                            uint64_t t4 = x3[4U];
                                            uint64_t t1_2 = t1 + (t012 >> (uint32_t)51U);
                                            uint64_t t0_2 = t012 & (uint64_t)0x7ffffffffffffU;
                                            uint64_t t2_2 = t2 + (t1_2 >> (uint32_t)51U);
                                            uint64_t t1__2 = t1_2 & (uint64_t)0x7ffffffffffffU;
                                            uint64_t t3_2 = t3 + (t2_2 >> (uint32_t)51U);
                                            uint64_t t2__2 = t2_2 & (uint64_t)0x7ffffffffffffU;
                                            uint64_t t4_2 = t4 + (t3_2 >> (uint32_t)51U);
                                            uint64_t t3__2 = t3_2 & (uint64_t)0x7ffffffffffffU;
                                            x3[0U] = t0_2;
                                            x3[1U] = t1__2;
                                            x3[2U] = t2__2;
                                            x3[3U] = t3__2;
                                            x3[4U] = t4_2;
                                            Hacl_Bignum_Modulo_carry_top(x3);
                                            {
                                              uint64_t i02 = x3[0U];
                                              uint64_t i1 = x3[1U];
                                              uint64_t i0_2 = i02 & (uint64_t)0x7ffffffffffffU;
                                              uint64_t i1_2 = i1 + (i02 >> (uint32_t)51U);
                                              x3[0U] = i0_2;
                                              x3[1U] = i1_2;
                                              Hacl_EC_Format_reduce(x3);
                                            }
                                          }
                                        }
                                        memcpy(x, x3, (uint32_t)5U * sizeof x3[0U]);
                                        ite = true;
                                      }
                                      ite1 = ite;
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                  ite0 = ite1;
                }
                res = ite0;
              }
            }
          }
        }
      }
    }
  }
  {
    bool res0 = res;
    return res0;
  }
}

static void Hacl_Impl_Load51_load_51(uint64_t *output, uint8_t *input)
{
  Hacl_EC_Format_fexpand(output, input);
}

static uint64_t *Hacl_Impl_Ed25519_ExtPoint_getx(uint64_t *p10)
{
  return p10;
}

static uint64_t *Hacl_Impl_Ed25519_ExtPoint_gety(uint64_t *p10)
{
  return p10 + (uint32_t)5U;
}

static uint64_t *Hacl_Impl_Ed25519_ExtPoint_getz(uint64_t *p10)
{
  return p10 + (uint32_t)10U;
}

static uint64_t *Hacl_Impl_Ed25519_ExtPoint_gett(uint64_t *p10)
{
  return p10 + (uint32_t)15U;
}

static bool Hacl_Impl_Ed25519_PointDecompress_point_decompress(uint64_t *out, uint8_t *s)
{
  uint64_t tmp[10U] = { 0U };
  uint64_t *y = tmp;
  uint64_t *x = tmp + (uint32_t)5U;
  uint64_t *y1 = tmp;
  uint64_t *x1 = tmp + (uint32_t)5U;
  uint8_t s31 = s[31U];
  uint8_t z0 = s31 >> (uint32_t)7U;
  uint64_t sign1 = (uint64_t)z0;
  bool z1;
  bool z;
  bool res0;
  bool res;
  Hacl_Impl_Load51_load_51(y1, s);
  z1 = Hacl_Impl_Ed25519_RecoverX_recover_x(x1, y1, sign1);
  z = z1;
  if (z == false)
  {
    res0 = false;
  }
  else
  {
    uint64_t *outx = Hacl_Impl_Ed25519_ExtPoint_getx(out);
    uint64_t *outy = Hacl_Impl_Ed25519_ExtPoint_gety(out);
    uint64_t *outz = Hacl_Impl_Ed25519_ExtPoint_getz(out);
    uint64_t *outt = Hacl_Impl_Ed25519_ExtPoint_gett(out);
    memcpy(outx, x, (uint32_t)5U * sizeof x[0U]);
    memcpy(outy, y, (uint32_t)5U * sizeof y[0U]);
    {
      uint64_t zero1 = (uint64_t)0U;
      uint64_t one1 = (uint64_t)1U;
      outz[0U] = one1;
      outz[1U] = zero1;
      outz[2U] = zero1;
      outz[3U] = zero1;
      outz[4U] = zero1;
      Hacl_Bignum_fmul(outt, x, y);
      res0 = true;
    }
  }
  res = res0;
  return res;
}

static void Hacl_Impl_Store56_store_56(uint8_t *out, uint64_t *b)
{
  uint64_t b0 = b[0U];
  uint64_t b1 = b[1U];
  uint64_t b2 = b[2U];
  uint64_t b3 = b[3U];
  uint64_t b4 = b[4U];
  uint32_t b41 = (uint32_t)b4;
  uint8_t *b80 = out;
  uint8_t *b81;
  uint8_t *b82;
  uint8_t *b8;
  uint8_t *x0;
  store64_le(b80, b0);
  b81 = out + (uint32_t)7U;
  store64_le(b81, b1);
  b82 = out + (uint32_t)14U;
  store64_le(b82, b2);
  b8 = out + (uint32_t)21U;
  store64_le(b8, b3);
  x0 = out + (uint32_t)28U;
  store32_le(x0, b41);
}

static bool Hacl_Impl_Ed25519_PointEqual_gte_q(uint64_t *s)
{
  uint64_t s0 = s[0U];
  uint64_t s1 = s[1U];
  uint64_t s2 = s[2U];
  uint64_t s3 = s[3U];
  uint64_t s4 = s[4U];
  if (s4 > (uint64_t)0x00000010000000U)
  {
    return true;
  }
  else
  {
    if (s4 < (uint64_t)0x00000010000000U)
    {
      return false;
    }
    else
    {
      if (s3 > (uint64_t)0x00000000000000U)
      {
        return true;
      }
      else
      {
        if (s2 > (uint64_t)0x000000000014deU)
        {
          return true;
        }
        else
        {
          if (s2 < (uint64_t)0x000000000014deU)
          {
            return false;
          }
          else
          {
            if (s1 > (uint64_t)0xf9dea2f79cd658U)
            {
              return true;
            }
            else
            {
              if (s1 < (uint64_t)0xf9dea2f79cd658U)
              {
                return false;
              }
              else
              {
                if (s0 >= (uint64_t)0x12631a5cf5d3edU)
                {
                  return true;
                }
                else
                {
                  return false;
                }
              }
            }
          }
        }
      }
    }
  }
}

static bool Hacl_Impl_Ed25519_PointEqual_eq(uint64_t *a, uint64_t *b)
{
  uint64_t a0 = a[0U];
  uint64_t a1 = a[1U];
  uint64_t a2 = a[2U];
  uint64_t a3 = a[3U];
  uint64_t a4 = a[4U];
  uint64_t b0 = b[0U];
  uint64_t b1 = b[1U];
  uint64_t b2 = b[2U];
  uint64_t b3 = b[3U];
  uint64_t b4 = b[4U];
  return a0 == b0 && a1 == b1 && a2 == b2 && a3 == b3 && a4 == b4;
}

static bool
Hacl_Impl_Ed25519_PointEqual_point_equal_1(uint64_t *p10, uint64_t *q1, uint64_t *tmp)
{
  uint64_t *pxqz = tmp;
  uint64_t *qxpz = tmp + (uint32_t)5U;
  bool b;
  Hacl_Bignum_fmul(pxqz,
    Hacl_Impl_Ed25519_ExtPoint_getx(p10),
    Hacl_Impl_Ed25519_ExtPoint_getz(q1));
  Hacl_EC_Format_reduce(pxqz);
  Hacl_Bignum_fmul(qxpz,
    Hacl_Impl_Ed25519_ExtPoint_getx(q1),
    Hacl_Impl_Ed25519_ExtPoint_getz(p10));
  Hacl_EC_Format_reduce(qxpz);
  b = Hacl_Impl_Ed25519_PointEqual_eq(pxqz, qxpz);
  return b;
}

static bool
Hacl_Impl_Ed25519_PointEqual_point_equal_2(uint64_t *p10, uint64_t *q1, uint64_t *tmp)
{
  uint64_t *pyqz = tmp + (uint32_t)10U;
  uint64_t *qypz = tmp + (uint32_t)15U;
  bool b;
  Hacl_Bignum_fmul(pyqz,
    Hacl_Impl_Ed25519_ExtPoint_gety(p10),
    Hacl_Impl_Ed25519_ExtPoint_getz(q1));
  Hacl_EC_Format_reduce(pyqz);
  Hacl_Bignum_fmul(qypz,
    Hacl_Impl_Ed25519_ExtPoint_gety(q1),
    Hacl_Impl_Ed25519_ExtPoint_getz(p10));
  Hacl_EC_Format_reduce(qypz);
  b = Hacl_Impl_Ed25519_PointEqual_eq(pyqz, qypz);
  return b;
}

static bool
Hacl_Impl_Ed25519_PointEqual_point_equal_(uint64_t *p10, uint64_t *q1, uint64_t *tmp)
{
  bool b = Hacl_Impl_Ed25519_PointEqual_point_equal_1(p10, q1, tmp);
  if (b == true)
  {
    return Hacl_Impl_Ed25519_PointEqual_point_equal_2(p10, q1, tmp);
  }
  else
  {
    return false;
  }
}

static bool Hacl_Impl_Ed25519_PointEqual_point_equal(uint64_t *p10, uint64_t *q1)
{
  uint64_t tmp[20U] = { 0U };
  bool res = Hacl_Impl_Ed25519_PointEqual_point_equal_(p10, q1, tmp);
  return res;
}

static void
Hacl_Hash_Lib_LoadStore_uint64s_from_be_bytes(uint64_t *output, uint8_t *input, uint32_t len1)
{
  uint32_t i;
  for (i = (uint32_t)0U; i < len1; i = i + (uint32_t)1U)
  {
    uint8_t *x0 = input + (uint32_t)8U * i;
    uint64_t inputi = load64_be(x0);
    output[i] = inputi;
  }
}

static void
Hacl_Hash_Lib_LoadStore_uint64s_to_be_bytes(uint8_t *output, uint64_t *input, uint32_t len1)
{
  uint32_t i;
  for (i = (uint32_t)0U; i < len1; i = i + (uint32_t)1U)
  {
    uint64_t hd1 = input[i];
    uint8_t *x0 = output + (uint32_t)8U * i;
    store64_be(x0, hd1);
  }
}

static void Hacl_Impl_SHA2_512_assign_k(uint64_t *b)
{
  uint64_t *b_hd = b;
  uint64_t *b_tl = b + (uint32_t)1U;
  uint64_t *b_hd1;
  uint64_t *b_tl1;
  uint64_t *b_hd2;
  uint64_t *b_tl2;
  uint64_t *b_hd3;
  uint64_t *b_tl3;
  uint64_t *b_hd4;
  uint64_t *b_tl4;
  uint64_t *b_hd5;
  uint64_t *b_tl5;
  uint64_t *b_hd6;
  uint64_t *b_tl6;
  uint64_t *b_hd7;
  uint64_t *b_tl7;
  uint64_t *b_hd8;
  uint64_t *b_tl8;
  uint64_t *b_hd9;
  uint64_t *b_tl9;
  uint64_t *b_hd10;
  uint64_t *b_tl10;
  uint64_t *b_hd11;
  uint64_t *b_tl11;
  uint64_t *b_hd12;
  uint64_t *b_tl12;
  uint64_t *b_hd13;
  uint64_t *b_tl13;
  uint64_t *b_hd14;
  uint64_t *b_tl14;
  uint64_t *b_hd15;
  uint64_t *b_tl15;
  uint64_t *b_hd16;
  uint64_t *b_tl16;
  uint64_t *b_hd17;
  uint64_t *b_tl17;
  uint64_t *b_hd18;
  uint64_t *b_tl18;
  uint64_t *b_hd19;
  uint64_t *b_tl19;
  uint64_t *b_hd20;
  uint64_t *b_tl20;
  uint64_t *b_hd21;
  uint64_t *b_tl21;
  uint64_t *b_hd22;
  uint64_t *b_tl22;
  uint64_t *b_hd23;
  uint64_t *b_tl23;
  uint64_t *b_hd24;
  uint64_t *b_tl24;
  uint64_t *b_hd25;
  uint64_t *b_tl25;
  uint64_t *b_hd26;
  uint64_t *b_tl26;
  uint64_t *b_hd27;
  uint64_t *b_tl27;
  uint64_t *b_hd28;
  uint64_t *b_tl28;
  uint64_t *b_hd29;
  uint64_t *b_tl29;
  uint64_t *b_hd30;
  uint64_t *b_tl30;
  uint64_t *b_hd31;
  uint64_t *b_tl31;
  uint64_t *b_hd32;
  uint64_t *b_tl32;
  uint64_t *b_hd33;
  uint64_t *b_tl33;
  uint64_t *b_hd34;
  uint64_t *b_tl34;
  uint64_t *b_hd35;
  uint64_t *b_tl35;
  uint64_t *b_hd36;
  uint64_t *b_tl36;
  uint64_t *b_hd37;
  uint64_t *b_tl37;
  uint64_t *b_hd38;
  uint64_t *b_tl38;
  uint64_t *b_hd39;
  uint64_t *b_tl39;
  uint64_t *b_hd40;
  uint64_t *b_tl40;
  uint64_t *b_hd41;
  uint64_t *b_tl41;
  uint64_t *b_hd42;
  uint64_t *b_tl42;
  uint64_t *b_hd43;
  uint64_t *b_tl43;
  uint64_t *b_hd44;
  uint64_t *b_tl44;
  uint64_t *b_hd45;
  uint64_t *b_tl45;
  uint64_t *b_hd46;
  uint64_t *b_tl46;
  uint64_t *b_hd47;
  uint64_t *b_tl47;
  uint64_t *b_hd48;
  uint64_t *b_tl48;
  uint64_t *b_hd49;
  uint64_t *b_tl49;
  uint64_t *b_hd50;
  uint64_t *b_tl50;
  uint64_t *b_hd51;
  uint64_t *b_tl51;
  uint64_t *b_hd52;
  uint64_t *b_tl52;
  uint64_t *b_hd53;
  uint64_t *b_tl53;
  uint64_t *b_hd54;
  uint64_t *b_tl54;
  uint64_t *b_hd55;
  uint64_t *b_tl55;
  uint64_t *b_hd56;
  uint64_t *b_tl56;
  uint64_t *b_hd57;
  uint64_t *b_tl57;
  uint64_t *b_hd58;
  uint64_t *b_tl58;
  uint64_t *b_hd59;
  uint64_t *b_tl59;
  uint64_t *b_hd60;
  uint64_t *b_tl60;
  uint64_t *b_hd61;
  uint64_t *b_tl61;
  uint64_t *b_hd62;
  uint64_t *b_tl62;
  uint64_t *b_hd63;
  uint64_t *b_tl63;
  uint64_t *b_hd64;
  uint64_t *b_tl64;
  uint64_t *b_hd65;
  uint64_t *b_tl65;
  uint64_t *b_hd66;
  uint64_t *b_tl66;
  uint64_t *b_hd67;
  uint64_t *b_tl67;
  uint64_t *b_hd68;
  uint64_t *b_tl68;
  uint64_t *b_hd69;
  uint64_t *b_tl69;
  uint64_t *b_hd70;
  uint64_t *b_tl70;
  uint64_t *b_hd71;
  uint64_t *b_tl71;
  uint64_t *b_hd72;
  uint64_t *b_tl72;
  uint64_t *b_hd73;
  uint64_t *b_tl73;
  uint64_t *b_hd74;
  uint64_t *b_tl74;
  uint64_t *b_hd75;
  uint64_t *b_tl75;
  uint64_t *b_hd76;
  uint64_t *b_tl76;
  uint64_t *b_hd77;
  uint64_t *b_tl77;
  uint64_t *b_hd78;
  uint64_t *b_tl78;
  uint64_t *b_hd79;
  b_hd[0U] = (uint64_t)0x428a2f98d728ae22U;
  b_hd1 = b_tl;
  b_tl1 = b_tl + (uint32_t)1U;
  b_hd1[0U] = (uint64_t)0x7137449123ef65cdU;
  b_hd2 = b_tl1;
  b_tl2 = b_tl1 + (uint32_t)1U;
  b_hd2[0U] = (uint64_t)0xb5c0fbcfec4d3b2fU;
  b_hd3 = b_tl2;
  b_tl3 = b_tl2 + (uint32_t)1U;
  b_hd3[0U] = (uint64_t)0xe9b5dba58189dbbcU;
  b_hd4 = b_tl3;
  b_tl4 = b_tl3 + (uint32_t)1U;
  b_hd4[0U] = (uint64_t)0x3956c25bf348b538U;
  b_hd5 = b_tl4;
  b_tl5 = b_tl4 + (uint32_t)1U;
  b_hd5[0U] = (uint64_t)0x59f111f1b605d019U;
  b_hd6 = b_tl5;
  b_tl6 = b_tl5 + (uint32_t)1U;
  b_hd6[0U] = (uint64_t)0x923f82a4af194f9bU;
  b_hd7 = b_tl6;
  b_tl7 = b_tl6 + (uint32_t)1U;
  b_hd7[0U] = (uint64_t)0xab1c5ed5da6d8118U;
  b_hd8 = b_tl7;
  b_tl8 = b_tl7 + (uint32_t)1U;
  b_hd8[0U] = (uint64_t)0xd807aa98a3030242U;
  b_hd9 = b_tl8;
  b_tl9 = b_tl8 + (uint32_t)1U;
  b_hd9[0U] = (uint64_t)0x12835b0145706fbeU;
  b_hd10 = b_tl9;
  b_tl10 = b_tl9 + (uint32_t)1U;
  b_hd10[0U] = (uint64_t)0x243185be4ee4b28cU;
  b_hd11 = b_tl10;
  b_tl11 = b_tl10 + (uint32_t)1U;
  b_hd11[0U] = (uint64_t)0x550c7dc3d5ffb4e2U;
  b_hd12 = b_tl11;
  b_tl12 = b_tl11 + (uint32_t)1U;
  b_hd12[0U] = (uint64_t)0x72be5d74f27b896fU;
  b_hd13 = b_tl12;
  b_tl13 = b_tl12 + (uint32_t)1U;
  b_hd13[0U] = (uint64_t)0x80deb1fe3b1696b1U;
  b_hd14 = b_tl13;
  b_tl14 = b_tl13 + (uint32_t)1U;
  b_hd14[0U] = (uint64_t)0x9bdc06a725c71235U;
  b_hd15 = b_tl14;
  b_tl15 = b_tl14 + (uint32_t)1U;
  b_hd15[0U] = (uint64_t)0xc19bf174cf692694U;
  b_hd16 = b_tl15;
  b_tl16 = b_tl15 + (uint32_t)1U;
  b_hd16[0U] = (uint64_t)0xe49b69c19ef14ad2U;
  b_hd17 = b_tl16;
  b_tl17 = b_tl16 + (uint32_t)1U;
  b_hd17[0U] = (uint64_t)0xefbe4786384f25e3U;
  b_hd18 = b_tl17;
  b_tl18 = b_tl17 + (uint32_t)1U;
  b_hd18[0U] = (uint64_t)0x0fc19dc68b8cd5b5U;
  b_hd19 = b_tl18;
  b_tl19 = b_tl18 + (uint32_t)1U;
  b_hd19[0U] = (uint64_t)0x240ca1cc77ac9c65U;
  b_hd20 = b_tl19;
  b_tl20 = b_tl19 + (uint32_t)1U;
  b_hd20[0U] = (uint64_t)0x2de92c6f592b0275U;
  b_hd21 = b_tl20;
  b_tl21 = b_tl20 + (uint32_t)1U;
  b_hd21[0U] = (uint64_t)0x4a7484aa6ea6e483U;
  b_hd22 = b_tl21;
  b_tl22 = b_tl21 + (uint32_t)1U;
  b_hd22[0U] = (uint64_t)0x5cb0a9dcbd41fbd4U;
  b_hd23 = b_tl22;
  b_tl23 = b_tl22 + (uint32_t)1U;
  b_hd23[0U] = (uint64_t)0x76f988da831153b5U;
  b_hd24 = b_tl23;
  b_tl24 = b_tl23 + (uint32_t)1U;
  b_hd24[0U] = (uint64_t)0x983e5152ee66dfabU;
  b_hd25 = b_tl24;
  b_tl25 = b_tl24 + (uint32_t)1U;
  b_hd25[0U] = (uint64_t)0xa831c66d2db43210U;
  b_hd26 = b_tl25;
  b_tl26 = b_tl25 + (uint32_t)1U;
  b_hd26[0U] = (uint64_t)0xb00327c898fb213fU;
  b_hd27 = b_tl26;
  b_tl27 = b_tl26 + (uint32_t)1U;
  b_hd27[0U] = (uint64_t)0xbf597fc7beef0ee4U;
  b_hd28 = b_tl27;
  b_tl28 = b_tl27 + (uint32_t)1U;
  b_hd28[0U] = (uint64_t)0xc6e00bf33da88fc2U;
  b_hd29 = b_tl28;
  b_tl29 = b_tl28 + (uint32_t)1U;
  b_hd29[0U] = (uint64_t)0xd5a79147930aa725U;
  b_hd30 = b_tl29;
  b_tl30 = b_tl29 + (uint32_t)1U;
  b_hd30[0U] = (uint64_t)0x06ca6351e003826fU;
  b_hd31 = b_tl30;
  b_tl31 = b_tl30 + (uint32_t)1U;
  b_hd31[0U] = (uint64_t)0x142929670a0e6e70U;
  b_hd32 = b_tl31;
  b_tl32 = b_tl31 + (uint32_t)1U;
  b_hd32[0U] = (uint64_t)0x27b70a8546d22ffcU;
  b_hd33 = b_tl32;
  b_tl33 = b_tl32 + (uint32_t)1U;
  b_hd33[0U] = (uint64_t)0x2e1b21385c26c926U;
  b_hd34 = b_tl33;
  b_tl34 = b_tl33 + (uint32_t)1U;
  b_hd34[0U] = (uint64_t)0x4d2c6dfc5ac42aedU;
  b_hd35 = b_tl34;
  b_tl35 = b_tl34 + (uint32_t)1U;
  b_hd35[0U] = (uint64_t)0x53380d139d95b3dfU;
  b_hd36 = b_tl35;
  b_tl36 = b_tl35 + (uint32_t)1U;
  b_hd36[0U] = (uint64_t)0x650a73548baf63deU;
  b_hd37 = b_tl36;
  b_tl37 = b_tl36 + (uint32_t)1U;
  b_hd37[0U] = (uint64_t)0x766a0abb3c77b2a8U;
  b_hd38 = b_tl37;
  b_tl38 = b_tl37 + (uint32_t)1U;
  b_hd38[0U] = (uint64_t)0x81c2c92e47edaee6U;
  b_hd39 = b_tl38;
  b_tl39 = b_tl38 + (uint32_t)1U;
  b_hd39[0U] = (uint64_t)0x92722c851482353bU;
  b_hd40 = b_tl39;
  b_tl40 = b_tl39 + (uint32_t)1U;
  b_hd40[0U] = (uint64_t)0xa2bfe8a14cf10364U;
  b_hd41 = b_tl40;
  b_tl41 = b_tl40 + (uint32_t)1U;
  b_hd41[0U] = (uint64_t)0xa81a664bbc423001U;
  b_hd42 = b_tl41;
  b_tl42 = b_tl41 + (uint32_t)1U;
  b_hd42[0U] = (uint64_t)0xc24b8b70d0f89791U;
  b_hd43 = b_tl42;
  b_tl43 = b_tl42 + (uint32_t)1U;
  b_hd43[0U] = (uint64_t)0xc76c51a30654be30U;
  b_hd44 = b_tl43;
  b_tl44 = b_tl43 + (uint32_t)1U;
  b_hd44[0U] = (uint64_t)0xd192e819d6ef5218U;
  b_hd45 = b_tl44;
  b_tl45 = b_tl44 + (uint32_t)1U;
  b_hd45[0U] = (uint64_t)0xd69906245565a910U;
  b_hd46 = b_tl45;
  b_tl46 = b_tl45 + (uint32_t)1U;
  b_hd46[0U] = (uint64_t)0xf40e35855771202aU;
  b_hd47 = b_tl46;
  b_tl47 = b_tl46 + (uint32_t)1U;
  b_hd47[0U] = (uint64_t)0x106aa07032bbd1b8U;
  b_hd48 = b_tl47;
  b_tl48 = b_tl47 + (uint32_t)1U;
  b_hd48[0U] = (uint64_t)0x19a4c116b8d2d0c8U;
  b_hd49 = b_tl48;
  b_tl49 = b_tl48 + (uint32_t)1U;
  b_hd49[0U] = (uint64_t)0x1e376c085141ab53U;
  b_hd50 = b_tl49;
  b_tl50 = b_tl49 + (uint32_t)1U;
  b_hd50[0U] = (uint64_t)0x2748774cdf8eeb99U;
  b_hd51 = b_tl50;
  b_tl51 = b_tl50 + (uint32_t)1U;
  b_hd51[0U] = (uint64_t)0x34b0bcb5e19b48a8U;
  b_hd52 = b_tl51;
  b_tl52 = b_tl51 + (uint32_t)1U;
  b_hd52[0U] = (uint64_t)0x391c0cb3c5c95a63U;
  b_hd53 = b_tl52;
  b_tl53 = b_tl52 + (uint32_t)1U;
  b_hd53[0U] = (uint64_t)0x4ed8aa4ae3418acbU;
  b_hd54 = b_tl53;
  b_tl54 = b_tl53 + (uint32_t)1U;
  b_hd54[0U] = (uint64_t)0x5b9cca4f7763e373U;
  b_hd55 = b_tl54;
  b_tl55 = b_tl54 + (uint32_t)1U;
  b_hd55[0U] = (uint64_t)0x682e6ff3d6b2b8a3U;
  b_hd56 = b_tl55;
  b_tl56 = b_tl55 + (uint32_t)1U;
  b_hd56[0U] = (uint64_t)0x748f82ee5defb2fcU;
  b_hd57 = b_tl56;
  b_tl57 = b_tl56 + (uint32_t)1U;
  b_hd57[0U] = (uint64_t)0x78a5636f43172f60U;
  b_hd58 = b_tl57;
  b_tl58 = b_tl57 + (uint32_t)1U;
  b_hd58[0U] = (uint64_t)0x84c87814a1f0ab72U;
  b_hd59 = b_tl58;
  b_tl59 = b_tl58 + (uint32_t)1U;
  b_hd59[0U] = (uint64_t)0x8cc702081a6439ecU;
  b_hd60 = b_tl59;
  b_tl60 = b_tl59 + (uint32_t)1U;
  b_hd60[0U] = (uint64_t)0x90befffa23631e28U;
  b_hd61 = b_tl60;
  b_tl61 = b_tl60 + (uint32_t)1U;
  b_hd61[0U] = (uint64_t)0xa4506cebde82bde9U;
  b_hd62 = b_tl61;
  b_tl62 = b_tl61 + (uint32_t)1U;
  b_hd62[0U] = (uint64_t)0xbef9a3f7b2c67915U;
  b_hd63 = b_tl62;
  b_tl63 = b_tl62 + (uint32_t)1U;
  b_hd63[0U] = (uint64_t)0xc67178f2e372532bU;
  b_hd64 = b_tl63;
  b_tl64 = b_tl63 + (uint32_t)1U;
  b_hd64[0U] = (uint64_t)0xca273eceea26619cU;
  b_hd65 = b_tl64;
  b_tl65 = b_tl64 + (uint32_t)1U;
  b_hd65[0U] = (uint64_t)0xd186b8c721c0c207U;
  b_hd66 = b_tl65;
  b_tl66 = b_tl65 + (uint32_t)1U;
  b_hd66[0U] = (uint64_t)0xeada7dd6cde0eb1eU;
  b_hd67 = b_tl66;
  b_tl67 = b_tl66 + (uint32_t)1U;
  b_hd67[0U] = (uint64_t)0xf57d4f7fee6ed178U;
  b_hd68 = b_tl67;
  b_tl68 = b_tl67 + (uint32_t)1U;
  b_hd68[0U] = (uint64_t)0x06f067aa72176fbaU;
  b_hd69 = b_tl68;
  b_tl69 = b_tl68 + (uint32_t)1U;
  b_hd69[0U] = (uint64_t)0x0a637dc5a2c898a6U;
  b_hd70 = b_tl69;
  b_tl70 = b_tl69 + (uint32_t)1U;
  b_hd70[0U] = (uint64_t)0x113f9804bef90daeU;
  b_hd71 = b_tl70;
  b_tl71 = b_tl70 + (uint32_t)1U;
  b_hd71[0U] = (uint64_t)0x1b710b35131c471bU;
  b_hd72 = b_tl71;
  b_tl72 = b_tl71 + (uint32_t)1U;
  b_hd72[0U] = (uint64_t)0x28db77f523047d84U;
  b_hd73 = b_tl72;
  b_tl73 = b_tl72 + (uint32_t)1U;
  b_hd73[0U] = (uint64_t)0x32caab7b40c72493U;
  b_hd74 = b_tl73;
  b_tl74 = b_tl73 + (uint32_t)1U;
  b_hd74[0U] = (uint64_t)0x3c9ebe0a15c9bebcU;
  b_hd75 = b_tl74;
  b_tl75 = b_tl74 + (uint32_t)1U;
  b_hd75[0U] = (uint64_t)0x431d67c49c100d4cU;
  b_hd76 = b_tl75;
  b_tl76 = b_tl75 + (uint32_t)1U;
  b_hd76[0U] = (uint64_t)0x4cc5d4becb3e42b6U;
  b_hd77 = b_tl76;
  b_tl77 = b_tl76 + (uint32_t)1U;
  b_hd77[0U] = (uint64_t)0x597f299cfc657e2aU;
  b_hd78 = b_tl77;
  b_tl78 = b_tl77 + (uint32_t)1U;
  b_hd78[0U] = (uint64_t)0x5fcb6fab3ad6faecU;
  b_hd79 = b_tl78;
  b_hd79[0U] = (uint64_t)0x6c44198c4a475817U;
}

static void Hacl_Impl_SHA2_512_constants_set_k(uint64_t *k1)
{
  Hacl_Impl_SHA2_512_assign_k(k1);
}

static void Hacl_Impl_SHA2_512_assign_h0(uint64_t *b)
{
  uint64_t *b_hd = b;
  uint64_t *b_tl = b + (uint32_t)1U;
  uint64_t *b_hd1;
  uint64_t *b_tl1;
  uint64_t *b_hd2;
  uint64_t *b_tl2;
  uint64_t *b_hd3;
  uint64_t *b_tl3;
  uint64_t *b_hd4;
  uint64_t *b_tl4;
  uint64_t *b_hd5;
  uint64_t *b_tl5;
  uint64_t *b_hd6;
  uint64_t *b_tl6;
  uint64_t *b_hd7;
  b_hd[0U] = (uint64_t)0x6a09e667f3bcc908U;
  b_hd1 = b_tl;
  b_tl1 = b_tl + (uint32_t)1U;
  b_hd1[0U] = (uint64_t)0xbb67ae8584caa73bU;
  b_hd2 = b_tl1;
  b_tl2 = b_tl1 + (uint32_t)1U;
  b_hd2[0U] = (uint64_t)0x3c6ef372fe94f82bU;
  b_hd3 = b_tl2;
  b_tl3 = b_tl2 + (uint32_t)1U;
  b_hd3[0U] = (uint64_t)0xa54ff53a5f1d36f1U;
  b_hd4 = b_tl3;
  b_tl4 = b_tl3 + (uint32_t)1U;
  b_hd4[0U] = (uint64_t)0x510e527fade682d1U;
  b_hd5 = b_tl4;
  b_tl5 = b_tl4 + (uint32_t)1U;
  b_hd5[0U] = (uint64_t)0x9b05688c2b3e6c1fU;
  b_hd6 = b_tl5;
  b_tl6 = b_tl5 + (uint32_t)1U;
  b_hd6[0U] = (uint64_t)0x1f83d9abfb41bd6bU;
  b_hd7 = b_tl6;
  b_hd7[0U] = (uint64_t)0x5be0cd19137e2179U;
}

static void Hacl_Impl_SHA2_512_init(uint64_t *state)
{
  uint64_t *n1 = state + (uint32_t)168U;
  uint64_t *k1 = state;
  uint64_t *h_01 = state + (uint32_t)160U;
  Hacl_Impl_SHA2_512_constants_set_k(k1);
  Hacl_Impl_SHA2_512_assign_h0(h_01);
  n1[0U] = (uint64_t)0U;
}

static void Hacl_Impl_SHA2_512_update(uint64_t *state, uint8_t *data)
{
  uint64_t data_w[16U];
  {
    uint32_t _i;
    for (_i = 0U; _i < (uint32_t)16U; ++_i)
      data_w[_i] = (uint64_t)(uint32_t)0U;
  }
  {
    uint64_t *words_state;
    uint64_t *ws_w;
    uint64_t *k_w;
    uint64_t *counter_w;
    Hacl_Hash_Lib_LoadStore_uint64s_from_be_bytes(data_w, data, (uint32_t)16U);
    words_state = state + (uint32_t)160U;
    ws_w = state + (uint32_t)80U;
    k_w = state;
    counter_w = state + (uint32_t)168U;
    {
      uint32_t i;
      for (i = (uint32_t)0U; i < (uint32_t)16U; i = i + (uint32_t)1U)
      {
        uint64_t b = data_w[i];
        ws_w[i] = b;
      }
    }
    {
      uint32_t i;
      for (i = (uint32_t)16U; i < (uint32_t)80U; i = i + (uint32_t)1U)
      {
        uint64_t t16 = ws_w[i - (uint32_t)16U];
        uint64_t t15 = ws_w[i - (uint32_t)15U];
        uint64_t t7 = ws_w[i - (uint32_t)7U];
        uint64_t t2 = ws_w[i - (uint32_t)2U];
        ws_w[i] =
          ((t2 >> (uint32_t)19U | t2 << ((uint32_t)64U - (uint32_t)19U))
          ^ ((t2 >> (uint32_t)61U | t2 << ((uint32_t)64U - (uint32_t)61U)) ^ t2 >> (uint32_t)6U))
          +
            t7
            +
              ((t15 >> (uint32_t)1U | t15 << ((uint32_t)64U - (uint32_t)1U))
              ^
                ((t15 >> (uint32_t)8U | t15 << ((uint32_t)64U - (uint32_t)8U))
                ^ t15 >> (uint32_t)7U))
              + t16;
      }
    }
    {
      uint64_t hash_0[8U] = { 0U };
      uint64_t c0;
      uint64_t one1;
      memcpy(hash_0, words_state, (uint32_t)8U * sizeof words_state[0U]);
      {
        uint32_t i;
        for (i = (uint32_t)0U; i < (uint32_t)80U; i = i + (uint32_t)1U)
        {
          uint64_t a = hash_0[0U];
          uint64_t b = hash_0[1U];
          uint64_t c = hash_0[2U];
          uint64_t d1 = hash_0[3U];
          uint64_t e = hash_0[4U];
          uint64_t f = hash_0[5U];
          uint64_t g1 = hash_0[6U];
          uint64_t h = hash_0[7U];
          uint64_t k_t = k_w[i];
          uint64_t ws_t = ws_w[i];
          uint64_t
          t1 =
            h
            +
              ((e >> (uint32_t)14U | e << ((uint32_t)64U - (uint32_t)14U))
              ^
                ((e >> (uint32_t)18U | e << ((uint32_t)64U - (uint32_t)18U))
                ^ (e >> (uint32_t)41U | e << ((uint32_t)64U - (uint32_t)41U))))
            + ((e & f) ^ (~e & g1))
            + k_t
            + ws_t;
          uint64_t
          t2 =
            ((a >> (uint32_t)28U | a << ((uint32_t)64U - (uint32_t)28U))
            ^
              ((a >> (uint32_t)34U | a << ((uint32_t)64U - (uint32_t)34U))
              ^ (a >> (uint32_t)39U | a << ((uint32_t)64U - (uint32_t)39U))))
            + ((a & b) ^ ((a & c) ^ (b & c)));
          uint64_t x1 = t1 + t2;
          uint64_t x5 = d1 + t1;
          uint64_t *p1 = hash_0;
          uint64_t *p2 = hash_0 + (uint32_t)4U;
          p1[0U] = x1;
          p1[1U] = a;
          p1[2U] = b;
          p1[3U] = c;
          p2[0U] = x5;
          p2[1U] = e;
          p2[2U] = f;
          p2[3U] = g1;
        }
      }
      {
        uint32_t i;
        for (i = (uint32_t)0U; i < (uint32_t)8U; i = i + (uint32_t)1U)
        {
          uint64_t xi = words_state[i];
          uint64_t yi = hash_0[i];
          words_state[i] = xi + yi;
        }
      }
      c0 = counter_w[0U];
      one1 = (uint64_t)(uint32_t)1U;
      counter_w[0U] = c0 + one1;
    }
  }
}

static void Hacl_Impl_SHA2_512_update_multi(uint64_t *state, uint8_t *data, uint32_t n1)
{
  uint32_t i;
  for (i = (uint32_t)0U; i < n1; i = i + (uint32_t)1U)
  {
    uint8_t *b = data + i * (uint32_t)128U;
    Hacl_Impl_SHA2_512_update(state, b);
  }
}

static void Hacl_Impl_SHA2_512_update_last(uint64_t *state, uint8_t *data, uint32_t len1)
{
  uint8_t blocks[256U] = { 0U };
  uint32_t nb;
  if (len1 < (uint32_t)112U)
  {
    nb = (uint32_t)1U;
  }
  else
  {
    nb = (uint32_t)2U;
  }
  {
    uint8_t *final_blocks;
    if (len1 < (uint32_t)112U)
    {
      final_blocks = blocks + (uint32_t)128U;
    }
    else
    {
      final_blocks = blocks;
    }
    {
      uint64_t n1;
      uint8_t *padding;
      FStar_UInt128_uint128 l0;
      FStar_UInt128_uint128 l1;
      FStar_UInt128_uint128 encodedlen;
      uint32_t pad0len;
      uint8_t *buf1;
      uint8_t *buf2;
      memcpy(final_blocks, data, len1 * sizeof data[0U]);
      n1 = state[168U];
      padding = final_blocks + len1;
      l0 = FStar_UInt128_mul_wide((uint64_t)(uint32_t)n1, (uint64_t)(uint32_t)128U);
      l1 = FStar_UInt128_uint64_to_uint128((uint64_t)len1);
      encodedlen = FStar_UInt128_shift_left(FStar_UInt128_add(l0, l1), (uint32_t)3U);
      pad0len = ((uint32_t)256U - (len1 + (uint32_t)16U + (uint32_t)1U)) % (uint32_t)128U;
      buf1 = padding;
      buf2 = padding + (uint32_t)1U + pad0len;
      buf1[0U] = (uint8_t)0x80U;
      store128_be(buf2, encodedlen);
      Hacl_Impl_SHA2_512_update_multi(state, final_blocks, nb);
    }
  }
}

static void Hacl_Impl_SHA2_512_finish(uint64_t *state, uint8_t *hash1)
{
  uint64_t *words_state = state + (uint32_t)160U;
  Hacl_Hash_Lib_LoadStore_uint64s_to_be_bytes(hash1, words_state, (uint32_t)8U);
}

static void Hacl_Impl_SHA2_512_hash(uint8_t *hash1, uint8_t *input, uint32_t len1)
{
  uint64_t state[169U];
  {
    uint32_t _i;
    for (_i = 0U; _i < (uint32_t)169U; ++_i)
      state[_i] = (uint64_t)(uint32_t)0U;
  }
  {
    uint32_t n1 = len1 / (uint32_t)128U;
    uint32_t r = len1 % (uint32_t)128U;
    uint8_t *input_blocks = input;
    uint8_t *input_last = input + n1 * (uint32_t)128U;
    Hacl_Impl_SHA2_512_init(state);
    Hacl_Impl_SHA2_512_update_multi(state, input_blocks, n1);
    Hacl_Impl_SHA2_512_update_last(state, input_last, r);
    Hacl_Impl_SHA2_512_finish(state, hash1);
  }
}

static void
Hacl_Impl_SHA512_Ed25519_1_copy_bytes(uint8_t *output, uint8_t *input, uint32_t len1)
{
  memcpy(output, input, len1 * sizeof input[0U]);
}

static void
Hacl_Impl_SHA512_Ed25519_1_concat_2(uint8_t *out, uint8_t *pre, uint8_t *msg, uint32_t len1)
{
  Hacl_Impl_SHA512_Ed25519_1_copy_bytes(out, pre, (uint32_t)32U);
  Hacl_Impl_SHA512_Ed25519_1_copy_bytes(out + (uint32_t)32U, msg, len1);
}

static void
Hacl_Impl_SHA512_Ed25519_1_concat_3(
  uint8_t *out,
  uint8_t *pre,
  uint8_t *pre2,
  uint8_t *msg,
  uint32_t len1
)
{
  Hacl_Impl_SHA512_Ed25519_1_copy_bytes(out, pre, (uint32_t)32U);
  Hacl_Impl_SHA512_Ed25519_1_copy_bytes(out + (uint32_t)32U, pre2, (uint32_t)32U);
  Hacl_Impl_SHA512_Ed25519_1_copy_bytes(out + (uint32_t)64U, msg, len1);
}

static void
Hacl_Impl_SHA512_Ed25519_1_sha512_pre_msg_1(
  uint8_t *h,
  uint8_t *prefix,
  uint8_t *input,
  uint32_t len1
)
{
  uint8_t block[128U] = { 0U };
  uint8_t *block_ = block;
  Hacl_Impl_SHA512_Ed25519_1_concat_2(block_, prefix, input, len1);
  Hacl_Impl_SHA2_512_hash(h, block_, len1 + (uint32_t)32U);
}

static void
Hacl_Impl_SHA512_Ed25519_1_sha512_pre_pre2_msg_1(
  uint8_t *h,
  uint8_t *prefix,
  uint8_t *prefix2,
  uint8_t *input,
  uint32_t len1
)
{
  uint8_t block[128U] = { 0U };
  uint8_t *block_ = block;
  Hacl_Impl_SHA512_Ed25519_1_concat_3(block_, prefix, prefix2, input, len1);
  Hacl_Impl_SHA2_512_hash(h, block_, len1 + (uint32_t)64U);
}

static void
Hacl_Impl_SHA512_Ed25519_2_hash_block_and_rest(
  uint8_t *out,
  uint8_t *block,
  uint8_t *msg,
  uint32_t len1
)
{
  uint32_t nblocks = len1 >> (uint32_t)7U;
  uint32_t rest = len1 & (uint32_t)127U;
  uint64_t st[169U] = { 0U };
  Hacl_Impl_SHA2_512_init(st);
  Hacl_Impl_SHA2_512_update(st, block);
  Hacl_Impl_SHA2_512_update_multi(st, msg, nblocks);
  Hacl_Impl_SHA2_512_update_last(st, msg + (uint32_t)128U * nblocks, rest);
  Hacl_Impl_SHA2_512_finish(st, out);
}

static void
Hacl_Impl_SHA512_Ed25519_3_sha512_pre_msg_2(
  uint8_t *h,
  uint8_t *prefix,
  uint8_t *input,
  uint32_t len1
)
{
  uint8_t *input11 = input;
  uint8_t *input21 = input + (uint32_t)96U;
  uint8_t block[128U] = { 0U };
  Hacl_Impl_SHA512_Ed25519_1_concat_2(block, prefix, input11, (uint32_t)96U);
  Hacl_Impl_SHA512_Ed25519_2_hash_block_and_rest(h, block, input21, len1 - (uint32_t)96U);
}

static void
Hacl_Impl_SHA512_Ed25519_3_sha512_pre_msg(
  uint8_t *h,
  uint8_t *prefix,
  uint8_t *input,
  uint32_t len1
)
{
  if (len1 <= (uint32_t)96U)
  {
    Hacl_Impl_SHA512_Ed25519_1_sha512_pre_msg_1(h, prefix, input, len1);
  }
  else
  {
    Hacl_Impl_SHA512_Ed25519_3_sha512_pre_msg_2(h, prefix, input, len1);
  }
}

static void
Hacl_Impl_SHA512_Ed25519_3_sha512_pre_pre2_msg_2(
  uint8_t *h,
  uint8_t *prefix,
  uint8_t *prefix2,
  uint8_t *input,
  uint32_t len1
)
{
  uint8_t *input11 = input;
  uint8_t *input21 = input + (uint32_t)64U;
  uint8_t block[128U] = { 0U };
  Hacl_Impl_SHA512_Ed25519_1_concat_3(block, prefix, prefix2, input11, (uint32_t)64U);
  Hacl_Impl_SHA512_Ed25519_2_hash_block_and_rest(h, block, input21, len1 - (uint32_t)64U);
}

static void
Hacl_Impl_SHA512_Ed25519_3_sha512_pre_pre2_msg(
  uint8_t *h,
  uint8_t *prefix,
  uint8_t *prefix2,
  uint8_t *input,
  uint32_t len1
)
{
  if (len1 <= (uint32_t)64U)
  {
    Hacl_Impl_SHA512_Ed25519_1_sha512_pre_pre2_msg_1(h, prefix, prefix2, input, len1);
  }
  else
  {
    Hacl_Impl_SHA512_Ed25519_3_sha512_pre_pre2_msg_2(h, prefix, prefix2, input, len1);
  }
}

static void
Hacl_Impl_SHA512_Ed25519_sha512_pre_msg(
  uint8_t *h,
  uint8_t *prefix,
  uint8_t *input,
  uint32_t len1
)
{
  Hacl_Impl_SHA512_Ed25519_3_sha512_pre_msg(h, prefix, input, len1);
}

static void
Hacl_Impl_SHA512_Ed25519_sha512_pre_pre2_msg(
  uint8_t *h,
  uint8_t *prefix,
  uint8_t *prefix2,
  uint8_t *input,
  uint32_t len1
)
{
  Hacl_Impl_SHA512_Ed25519_3_sha512_pre_pre2_msg(h, prefix, prefix2, input, len1);
}

static void
Hacl_Impl_Sha512_sha512_pre_msg(uint8_t *h, uint8_t *prefix, uint8_t *input, uint32_t len1)
{
  Hacl_Impl_SHA512_Ed25519_sha512_pre_msg(h, prefix, input, len1);
}

static void
Hacl_Impl_Sha512_sha512_pre_pre2_msg(
  uint8_t *h,
  uint8_t *prefix,
  uint8_t *prefix2,
  uint8_t *input,
  uint32_t len1
)
{
  Hacl_Impl_SHA512_Ed25519_sha512_pre_pre2_msg(h, prefix, prefix2, input, len1);
}

static void Hacl_Impl_Load56_load_64_bytes(uint64_t *out, uint8_t *b)
{
  uint8_t *b80 = b;
  uint64_t z = load64_le(b80);
  uint64_t b0 = z & (uint64_t)0xffffffffffffffU;
  uint8_t *b81 = b + (uint32_t)7U;
  uint64_t z0 = load64_le(b81);
  uint64_t b1 = z0 & (uint64_t)0xffffffffffffffU;
  uint8_t *b82 = b + (uint32_t)14U;
  uint64_t z1 = load64_le(b82);
  uint64_t b2 = z1 & (uint64_t)0xffffffffffffffU;
  uint8_t *b83 = b + (uint32_t)21U;
  uint64_t z2 = load64_le(b83);
  uint64_t b3 = z2 & (uint64_t)0xffffffffffffffU;
  uint8_t *b84 = b + (uint32_t)28U;
  uint64_t z3 = load64_le(b84);
  uint64_t b4 = z3 & (uint64_t)0xffffffffffffffU;
  uint8_t *b85 = b + (uint32_t)35U;
  uint64_t z4 = load64_le(b85);
  uint64_t b5 = z4 & (uint64_t)0xffffffffffffffU;
  uint8_t *b86 = b + (uint32_t)42U;
  uint64_t z5 = load64_le(b86);
  uint64_t b6 = z5 & (uint64_t)0xffffffffffffffU;
  uint8_t *b87 = b + (uint32_t)49U;
  uint64_t z6 = load64_le(b87);
  uint64_t b7 = z6 & (uint64_t)0xffffffffffffffU;
  uint8_t *b8 = b + (uint32_t)56U;
  uint64_t z7 = load64_le(b8);
  uint64_t b88 = z7 & (uint64_t)0xffffffffffffffU;
  uint8_t b63 = b[63U];
  uint64_t b9 = (uint64_t)b63;
  out[0U] = b0;
  out[1U] = b1;
  out[2U] = b2;
  out[3U] = b3;
  out[4U] = b4;
  out[5U] = b5;
  out[6U] = b6;
  out[7U] = b7;
  out[8U] = b88;
  out[9U] = b9;
}

static void Hacl_Impl_Load56_load_32_bytes(uint64_t *out, uint8_t *b)
{
  uint8_t *b80 = b;
  uint64_t z = load64_le(b80);
  uint64_t b0 = z & (uint64_t)0xffffffffffffffU;
  uint8_t *b81 = b + (uint32_t)7U;
  uint64_t z0 = load64_le(b81);
  uint64_t b1 = z0 & (uint64_t)0xffffffffffffffU;
  uint8_t *b82 = b + (uint32_t)14U;
  uint64_t z1 = load64_le(b82);
  uint64_t b2 = z1 & (uint64_t)0xffffffffffffffU;
  uint8_t *b8 = b + (uint32_t)21U;
  uint64_t z2 = load64_le(b8);
  uint64_t b3 = z2 & (uint64_t)0xffffffffffffffU;
  uint8_t *x0 = b + (uint32_t)28U;
  uint32_t b4 = load32_le(x0);
  uint64_t b41 = (uint64_t)b4;
  out[0U] = b0;
  out[1U] = b1;
  out[2U] = b2;
  out[3U] = b3;
  out[4U] = b41;
}

static void Hacl_Impl_BignumQ_Mul_make_m(uint64_t *m1)
{
  m1[0U] = (uint64_t)0x12631a5cf5d3edU;
  m1[1U] = (uint64_t)0xf9dea2f79cd658U;
  m1[2U] = (uint64_t)0x000000000014deU;
  m1[3U] = (uint64_t)0x00000000000000U;
  m1[4U] = (uint64_t)0x00000010000000U;
}

static void Hacl_Impl_BignumQ_Mul_make_mu(uint64_t *m1)
{
  m1[0U] = (uint64_t)0x9ce5a30a2c131bU;
  m1[1U] = (uint64_t)0x215d086329a7edU;
  m1[2U] = (uint64_t)0xffffffffeb2106U;
  m1[3U] = (uint64_t)0xffffffffffffffU;
  m1[4U] = (uint64_t)0x00000fffffffffU;
}

static void Hacl_Impl_BignumQ_Mul_choose(uint64_t *z, uint64_t *x, uint64_t *y, uint64_t b)
{
  uint64_t mask = b - (uint64_t)1U;
  uint64_t x0 = x[0U];
  uint64_t x1 = x[1U];
  uint64_t x2 = x[2U];
  uint64_t x3 = x[3U];
  uint64_t x4 = x[4U];
  uint64_t y0 = y[0U];
  uint64_t y1 = y[1U];
  uint64_t y2 = y[2U];
  uint64_t y3 = y[3U];
  uint64_t y4 = y[4U];
  uint64_t z0 = ((y0 ^ x0) & mask) ^ x0;
  uint64_t z1 = ((y1 ^ x1) & mask) ^ x1;
  uint64_t z2 = ((y2 ^ x2) & mask) ^ x2;
  uint64_t z3 = ((y3 ^ x3) & mask) ^ x3;
  uint64_t z4 = ((y4 ^ x4) & mask) ^ x4;
  z[0U] = z0;
  z[1U] = z1;
  z[2U] = z2;
  z[3U] = z3;
  z[4U] = z4;
}

static uint64_t Hacl_Impl_BignumQ_Mul_lt(uint64_t a, uint64_t b)
{
  return (a - b) >> (uint32_t)63U;
}

static uint64_t Hacl_Impl_BignumQ_Mul_shiftl_56(uint64_t b)
{
  return b << (uint32_t)56U;
}

static void Hacl_Impl_BignumQ_Mul_sub_mod_264(uint64_t *z, uint64_t *x, uint64_t *y)
{
  uint64_t x0 = x[0U];
  uint64_t x1 = x[1U];
  uint64_t x2 = x[2U];
  uint64_t x3 = x[3U];
  uint64_t x4 = x[4U];
  uint64_t y0 = y[0U];
  uint64_t y1 = y[1U];
  uint64_t y2 = y[2U];
  uint64_t y3 = y[3U];
  uint64_t y4 = y[4U];
  uint64_t b = Hacl_Impl_BignumQ_Mul_lt(x0, y0);
  uint64_t t0 = Hacl_Impl_BignumQ_Mul_shiftl_56(b) + x0 - y0;
  uint64_t y11 = y1 + b;
  uint64_t b1 = Hacl_Impl_BignumQ_Mul_lt(x1, y11);
  uint64_t t1 = Hacl_Impl_BignumQ_Mul_shiftl_56(b1) + x1 - y11;
  uint64_t y21 = y2 + b1;
  uint64_t b2 = Hacl_Impl_BignumQ_Mul_lt(x2, y21);
  uint64_t t2 = Hacl_Impl_BignumQ_Mul_shiftl_56(b2) + x2 - y21;
  uint64_t y31 = y3 + b2;
  uint64_t b3 = Hacl_Impl_BignumQ_Mul_lt(x3, y31);
  uint64_t t3 = Hacl_Impl_BignumQ_Mul_shiftl_56(b3) + x3 - y31;
  uint64_t y41 = y4 + b3;
  uint64_t b4 = Hacl_Impl_BignumQ_Mul_lt(x4, y41);
  uint64_t t4 = (b4 << (uint32_t)40U) + x4 - y41;
  z[0U] = t0;
  z[1U] = t1;
  z[2U] = t2;
  z[3U] = t3;
  z[4U] = t4;
}

static void Hacl_Impl_BignumQ_Mul_subm_conditional(uint64_t *z, uint64_t *x)
{
  uint64_t tmp[5U] = { 0U };
  uint64_t x0 = x[0U];
  uint64_t x1 = x[1U];
  uint64_t x2 = x[2U];
  uint64_t x3 = x[3U];
  uint64_t x4 = x[4U];
  uint64_t y0;
  uint64_t y1;
  uint64_t y2;
  uint64_t y3;
  uint64_t y4;
  uint64_t b;
  uint64_t t0;
  uint64_t y11;
  uint64_t b1;
  uint64_t t1;
  uint64_t y21;
  uint64_t b2;
  uint64_t t2;
  uint64_t y31;
  uint64_t b3;
  uint64_t t3;
  uint64_t y41;
  uint64_t b4;
  uint64_t t4;
  tmp[0U] = x0;
  tmp[1U] = x1;
  tmp[2U] = x2;
  tmp[3U] = x3;
  tmp[4U] = x4;
  y0 = (uint64_t)0x12631a5cf5d3edU;
  y1 = (uint64_t)0xf9dea2f79cd658U;
  y2 = (uint64_t)0x000000000014deU;
  y3 = (uint64_t)0x00000000000000U;
  y4 = (uint64_t)0x00000010000000U;
  b = Hacl_Impl_BignumQ_Mul_lt(x0, y0);
  t0 = Hacl_Impl_BignumQ_Mul_shiftl_56(b) + x0 - y0;
  y11 = y1 + b;
  b1 = Hacl_Impl_BignumQ_Mul_lt(x1, y11);
  t1 = Hacl_Impl_BignumQ_Mul_shiftl_56(b1) + x1 - y11;
  y21 = y2 + b1;
  b2 = Hacl_Impl_BignumQ_Mul_lt(x2, y21);
  t2 = Hacl_Impl_BignumQ_Mul_shiftl_56(b2) + x2 - y21;
  y31 = y3 + b2;
  b3 = Hacl_Impl_BignumQ_Mul_lt(x3, y31);
  t3 = Hacl_Impl_BignumQ_Mul_shiftl_56(b3) + x3 - y31;
  y41 = y4 + b3;
  b4 = Hacl_Impl_BignumQ_Mul_lt(x4, y41);
  t4 = Hacl_Impl_BignumQ_Mul_shiftl_56(b4) + x4 - y41;
  z[0U] = t0;
  z[1U] = t1;
  z[2U] = t2;
  z[3U] = t3;
  z[4U] = t4;
  Hacl_Impl_BignumQ_Mul_choose(z, tmp, z, b4);
}

static void Hacl_Impl_BignumQ_Mul_low_mul_5(uint64_t *z, uint64_t *x, uint64_t *y)
{
  uint64_t x0 = x[0U];
  uint64_t x1 = x[1U];
  uint64_t x2 = x[2U];
  uint64_t x3 = x[3U];
  uint64_t x4 = x[4U];
  uint64_t y0 = y[0U];
  uint64_t y1 = y[1U];
  uint64_t y2 = y[2U];
  uint64_t y3 = y[3U];
  uint64_t y4 = y[4U];
  FStar_UInt128_uint128 xy00 = FStar_UInt128_mul_wide(x0, y0);
  FStar_UInt128_uint128 xy01 = FStar_UInt128_mul_wide(x0, y1);
  FStar_UInt128_uint128 xy02 = FStar_UInt128_mul_wide(x0, y2);
  FStar_UInt128_uint128 xy03 = FStar_UInt128_mul_wide(x0, y3);
  FStar_UInt128_uint128 xy04 = FStar_UInt128_mul_wide(x0, y4);
  FStar_UInt128_uint128 xy10 = FStar_UInt128_mul_wide(x1, y0);
  FStar_UInt128_uint128 xy11 = FStar_UInt128_mul_wide(x1, y1);
  FStar_UInt128_uint128 xy12 = FStar_UInt128_mul_wide(x1, y2);
  FStar_UInt128_uint128 xy13 = FStar_UInt128_mul_wide(x1, y3);
  FStar_UInt128_uint128 xy20 = FStar_UInt128_mul_wide(x2, y0);
  FStar_UInt128_uint128 xy21 = FStar_UInt128_mul_wide(x2, y1);
  FStar_UInt128_uint128 xy22 = FStar_UInt128_mul_wide(x2, y2);
  FStar_UInt128_uint128 xy30 = FStar_UInt128_mul_wide(x3, y0);
  FStar_UInt128_uint128 xy31 = FStar_UInt128_mul_wide(x3, y1);
  FStar_UInt128_uint128 xy40 = FStar_UInt128_mul_wide(x4, y0);
  FStar_UInt128_uint128 x5 = xy00;
  FStar_UInt128_uint128 carry1 = FStar_UInt128_shift_right(x5, (uint32_t)56U);
  uint64_t t = FStar_UInt128_uint128_to_uint64(x5) & (uint64_t)0xffffffffffffffU;
  uint64_t t0 = t;
  FStar_UInt128_uint128 x6 = FStar_UInt128_add(FStar_UInt128_add(xy01, xy10), carry1);
  FStar_UInt128_uint128 carry2 = FStar_UInt128_shift_right(x6, (uint32_t)56U);
  uint64_t t1 = FStar_UInt128_uint128_to_uint64(x6) & (uint64_t)0xffffffffffffffU;
  uint64_t t11 = t1;
  FStar_UInt128_uint128
  x7 = FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_add(xy02, xy11), xy20), carry2);
  FStar_UInt128_uint128 carry3 = FStar_UInt128_shift_right(x7, (uint32_t)56U);
  uint64_t t2 = FStar_UInt128_uint128_to_uint64(x7) & (uint64_t)0xffffffffffffffU;
  uint64_t t21 = t2;
  FStar_UInt128_uint128
  x8 =
    FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_add(xy03, xy12), xy21),
        xy30),
      carry3);
  FStar_UInt128_uint128 carry4 = FStar_UInt128_shift_right(x8, (uint32_t)56U);
  uint64_t t3 = FStar_UInt128_uint128_to_uint64(x8) & (uint64_t)0xffffffffffffffU;
  uint64_t t31 = t3;
  uint64_t
  x_ =
    FStar_UInt128_uint128_to_uint64(FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_add(xy04,
                xy13),
              xy22),
            xy31),
          xy40),
        carry4));
  uint64_t t4 = x_ & (uint64_t)0xffffffffffU;
  z[0U] = t0;
  z[1U] = t11;
  z[2U] = t21;
  z[3U] = t31;
  z[4U] = t4;
}

static void Hacl_Impl_BignumQ_Mul_mul_5(FStar_UInt128_uint128 *z, uint64_t *x, uint64_t *y)
{
  uint64_t x0 = x[0U];
  uint64_t x1 = x[1U];
  uint64_t x2 = x[2U];
  uint64_t x3 = x[3U];
  uint64_t x4 = x[4U];
  uint64_t y0 = y[0U];
  uint64_t y1 = y[1U];
  uint64_t y2 = y[2U];
  uint64_t y3 = y[3U];
  uint64_t y4 = y[4U];
  FStar_UInt128_uint128 xy00 = FStar_UInt128_mul_wide(x0, y0);
  FStar_UInt128_uint128 xy01 = FStar_UInt128_mul_wide(x0, y1);
  FStar_UInt128_uint128 xy02 = FStar_UInt128_mul_wide(x0, y2);
  FStar_UInt128_uint128 xy03 = FStar_UInt128_mul_wide(x0, y3);
  FStar_UInt128_uint128 xy04 = FStar_UInt128_mul_wide(x0, y4);
  FStar_UInt128_uint128 xy10 = FStar_UInt128_mul_wide(x1, y0);
  FStar_UInt128_uint128 xy11 = FStar_UInt128_mul_wide(x1, y1);
  FStar_UInt128_uint128 xy12 = FStar_UInt128_mul_wide(x1, y2);
  FStar_UInt128_uint128 xy13 = FStar_UInt128_mul_wide(x1, y3);
  FStar_UInt128_uint128 xy14 = FStar_UInt128_mul_wide(x1, y4);
  FStar_UInt128_uint128 xy20 = FStar_UInt128_mul_wide(x2, y0);
  FStar_UInt128_uint128 xy21 = FStar_UInt128_mul_wide(x2, y1);
  FStar_UInt128_uint128 xy22 = FStar_UInt128_mul_wide(x2, y2);
  FStar_UInt128_uint128 xy23 = FStar_UInt128_mul_wide(x2, y3);
  FStar_UInt128_uint128 xy24 = FStar_UInt128_mul_wide(x2, y4);
  FStar_UInt128_uint128 xy30 = FStar_UInt128_mul_wide(x3, y0);
  FStar_UInt128_uint128 xy31 = FStar_UInt128_mul_wide(x3, y1);
  FStar_UInt128_uint128 xy32 = FStar_UInt128_mul_wide(x3, y2);
  FStar_UInt128_uint128 xy33 = FStar_UInt128_mul_wide(x3, y3);
  FStar_UInt128_uint128 xy34 = FStar_UInt128_mul_wide(x3, y4);
  FStar_UInt128_uint128 xy40 = FStar_UInt128_mul_wide(x4, y0);
  FStar_UInt128_uint128 xy41 = FStar_UInt128_mul_wide(x4, y1);
  FStar_UInt128_uint128 xy42 = FStar_UInt128_mul_wide(x4, y2);
  FStar_UInt128_uint128 xy43 = FStar_UInt128_mul_wide(x4, y3);
  FStar_UInt128_uint128 xy44 = FStar_UInt128_mul_wide(x4, y4);
  FStar_UInt128_uint128 z0 = xy00;
  FStar_UInt128_uint128 z1 = FStar_UInt128_add(xy01, xy10);
  FStar_UInt128_uint128 z2 = FStar_UInt128_add(FStar_UInt128_add(xy02, xy11), xy20);
  FStar_UInt128_uint128
  z3 = FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_add(xy03, xy12), xy21), xy30);
  FStar_UInt128_uint128
  z4 =
    FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_add(xy04, xy13), xy22),
        xy31),
      xy40);
  FStar_UInt128_uint128
  z5 = FStar_UInt128_add(FStar_UInt128_add(FStar_UInt128_add(xy14, xy23), xy32), xy41);
  FStar_UInt128_uint128 z6 = FStar_UInt128_add(FStar_UInt128_add(xy24, xy33), xy42);
  FStar_UInt128_uint128 z7 = FStar_UInt128_add(xy34, xy43);
  FStar_UInt128_uint128 z8 = xy44;
  z[0U] = z0;
  z[1U] = z1;
  z[2U] = z2;
  z[3U] = z3;
  z[4U] = z4;
  z[5U] = z5;
  z[6U] = z6;
  z[7U] = z7;
  z[8U] = z8;
}

static void Hacl_Impl_BignumQ_Mul_carry(uint64_t *out, FStar_UInt128_uint128 *z)
{
  FStar_UInt128_uint128 z0 = z[0U];
  FStar_UInt128_uint128 z1 = z[1U];
  FStar_UInt128_uint128 z2 = z[2U];
  FStar_UInt128_uint128 z3 = z[3U];
  FStar_UInt128_uint128 z4 = z[4U];
  FStar_UInt128_uint128 z5 = z[5U];
  FStar_UInt128_uint128 z6 = z[6U];
  FStar_UInt128_uint128 z7 = z[7U];
  FStar_UInt128_uint128 z8 = z[8U];
  FStar_UInt128_uint128 x = z0;
  FStar_UInt128_uint128 y = z1;
  FStar_UInt128_uint128 carry1 = FStar_UInt128_shift_right(x, (uint32_t)56U);
  uint64_t t = FStar_UInt128_uint128_to_uint64(x) & (uint64_t)0xffffffffffffffU;
  uint64_t x0 = t;
  FStar_UInt128_uint128 z1_ = FStar_UInt128_add(y, carry1);
  FStar_UInt128_uint128 x1 = z1_;
  FStar_UInt128_uint128 y1 = z2;
  FStar_UInt128_uint128 carry2 = FStar_UInt128_shift_right(x1, (uint32_t)56U);
  uint64_t t1 = FStar_UInt128_uint128_to_uint64(x1) & (uint64_t)0xffffffffffffffU;
  uint64_t x11 = t1;
  FStar_UInt128_uint128 z2_ = FStar_UInt128_add(y1, carry2);
  FStar_UInt128_uint128 x2 = z2_;
  FStar_UInt128_uint128 y2 = z3;
  FStar_UInt128_uint128 carry3 = FStar_UInt128_shift_right(x2, (uint32_t)56U);
  uint64_t t2 = FStar_UInt128_uint128_to_uint64(x2) & (uint64_t)0xffffffffffffffU;
  uint64_t x21 = t2;
  FStar_UInt128_uint128 z3_ = FStar_UInt128_add(y2, carry3);
  FStar_UInt128_uint128 x3 = z3_;
  FStar_UInt128_uint128 y3 = z4;
  FStar_UInt128_uint128 carry4 = FStar_UInt128_shift_right(x3, (uint32_t)56U);
  uint64_t t3 = FStar_UInt128_uint128_to_uint64(x3) & (uint64_t)0xffffffffffffffU;
  uint64_t x31 = t3;
  FStar_UInt128_uint128 z4_ = FStar_UInt128_add(y3, carry4);
  FStar_UInt128_uint128 x4 = z4_;
  FStar_UInt128_uint128 y4 = z5;
  FStar_UInt128_uint128 carry5 = FStar_UInt128_shift_right(x4, (uint32_t)56U);
  uint64_t t4 = FStar_UInt128_uint128_to_uint64(x4) & (uint64_t)0xffffffffffffffU;
  uint64_t x41 = t4;
  FStar_UInt128_uint128 z5_ = FStar_UInt128_add(y4, carry5);
  FStar_UInt128_uint128 x5 = z5_;
  FStar_UInt128_uint128 y5 = z6;
  FStar_UInt128_uint128 carry6 = FStar_UInt128_shift_right(x5, (uint32_t)56U);
  uint64_t t5 = FStar_UInt128_uint128_to_uint64(x5) & (uint64_t)0xffffffffffffffU;
  uint64_t x51 = t5;
  FStar_UInt128_uint128 z6_ = FStar_UInt128_add(y5, carry6);
  FStar_UInt128_uint128 x6 = z6_;
  FStar_UInt128_uint128 y6 = z7;
  FStar_UInt128_uint128 carry7 = FStar_UInt128_shift_right(x6, (uint32_t)56U);
  uint64_t t6 = FStar_UInt128_uint128_to_uint64(x6) & (uint64_t)0xffffffffffffffU;
  uint64_t x61 = t6;
  FStar_UInt128_uint128 z7_ = FStar_UInt128_add(y6, carry7);
  FStar_UInt128_uint128 x7 = z7_;
  FStar_UInt128_uint128 y7 = z8;
  FStar_UInt128_uint128 carry8 = FStar_UInt128_shift_right(x7, (uint32_t)56U);
  uint64_t t7 = FStar_UInt128_uint128_to_uint64(x7) & (uint64_t)0xffffffffffffffU;
  uint64_t x71 = t7;
  FStar_UInt128_uint128 z8_ = FStar_UInt128_add(y7, carry8);
  FStar_UInt128_uint128 x8 = z8_;
  FStar_UInt128_uint128 y8 = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
  FStar_UInt128_uint128 carry9 = FStar_UInt128_shift_right(x8, (uint32_t)56U);
  uint64_t t8 = FStar_UInt128_uint128_to_uint64(x8) & (uint64_t)0xffffffffffffffU;
  uint64_t x81 = t8;
  FStar_UInt128_uint128 z9_ = FStar_UInt128_add(y8, carry9);
  uint64_t x9 = FStar_UInt128_uint128_to_uint64(z9_);
  out[0U] = x0;
  out[1U] = x11;
  out[2U] = x21;
  out[3U] = x31;
  out[4U] = x41;
  out[5U] = x51;
  out[6U] = x61;
  out[7U] = x71;
  out[8U] = x81;
  out[9U] = x9;
}

static void Hacl_Impl_BignumQ_Mul_mod_264(uint64_t *r, uint64_t *t)
{
  uint64_t x0 = t[0U];
  uint64_t x1 = t[1U];
  uint64_t x2 = t[2U];
  uint64_t x3 = t[3U];
  uint64_t x4 = t[4U];
  uint64_t x4_ = x4 & (uint64_t)0xffffffffffU;
  r[0U] = x0;
  r[1U] = x1;
  r[2U] = x2;
  r[3U] = x3;
  r[4U] = x4_;
}

static void Hacl_Impl_BignumQ_Mul_div_248(uint64_t *out, uint64_t *t)
{
  uint64_t x4 = t[4U];
  uint64_t x5 = t[5U];
  uint64_t x6 = t[6U];
  uint64_t x7 = t[7U];
  uint64_t x8 = t[8U];
  uint64_t x9 = t[9U];
  uint64_t y_ = (x5 & (uint64_t)0xffffffU) << (uint32_t)32U;
  uint64_t x_ = x4 >> (uint32_t)24U;
  uint64_t z0 = y_ | x_;
  uint64_t y_0 = (x6 & (uint64_t)0xffffffU) << (uint32_t)32U;
  uint64_t x_0 = x5 >> (uint32_t)24U;
  uint64_t z1 = y_0 | x_0;
  uint64_t y_1 = (x7 & (uint64_t)0xffffffU) << (uint32_t)32U;
  uint64_t x_1 = x6 >> (uint32_t)24U;
  uint64_t z2 = y_1 | x_1;
  uint64_t y_2 = (x8 & (uint64_t)0xffffffU) << (uint32_t)32U;
  uint64_t x_2 = x7 >> (uint32_t)24U;
  uint64_t z3 = y_2 | x_2;
  uint64_t y_3 = (x9 & (uint64_t)0xffffffU) << (uint32_t)32U;
  uint64_t x_3 = x8 >> (uint32_t)24U;
  uint64_t z4 = y_3 | x_3;
  out[0U] = z0;
  out[1U] = z1;
  out[2U] = z2;
  out[3U] = z3;
  out[4U] = z4;
}

static void Hacl_Impl_BignumQ_Mul_div_264(uint64_t *out, uint64_t *t)
{
  uint64_t x4 = t[4U];
  uint64_t x5 = t[5U];
  uint64_t x6 = t[6U];
  uint64_t x7 = t[7U];
  uint64_t x8 = t[8U];
  uint64_t x9 = t[9U];
  uint64_t y_ = (x5 & (uint64_t)0xffffffffffU) << (uint32_t)16U;
  uint64_t x_ = x4 >> (uint32_t)40U;
  uint64_t z0 = y_ | x_;
  uint64_t y_0 = (x6 & (uint64_t)0xffffffffffU) << (uint32_t)16U;
  uint64_t x_0 = x5 >> (uint32_t)40U;
  uint64_t z1 = y_0 | x_0;
  uint64_t y_1 = (x7 & (uint64_t)0xffffffffffU) << (uint32_t)16U;
  uint64_t x_1 = x6 >> (uint32_t)40U;
  uint64_t z2 = y_1 | x_1;
  uint64_t y_2 = (x8 & (uint64_t)0xffffffffffU) << (uint32_t)16U;
  uint64_t x_2 = x7 >> (uint32_t)40U;
  uint64_t z3 = y_2 | x_2;
  uint64_t y_3 = (x9 & (uint64_t)0xffffffffffU) << (uint32_t)16U;
  uint64_t x_3 = x8 >> (uint32_t)40U;
  uint64_t z4 = y_3 | x_3;
  out[0U] = z0;
  out[1U] = z1;
  out[2U] = z2;
  out[3U] = z3;
  out[4U] = z4;
}

static void
Hacl_Impl_BignumQ_Mul_barrett_reduction__1(
  FStar_UInt128_uint128 *qmu,
  uint64_t *t,
  uint64_t *mu1,
  uint64_t *tmp
)
{
  uint64_t *q1 = tmp;
  uint64_t *qmu_ = tmp + (uint32_t)10U;
  uint64_t *qmu_264 = tmp + (uint32_t)20U;
  Hacl_Impl_BignumQ_Mul_div_248(q1, t);
  Hacl_Impl_BignumQ_Mul_mul_5(qmu, q1, mu1);
  Hacl_Impl_BignumQ_Mul_carry(qmu_, qmu);
  Hacl_Impl_BignumQ_Mul_div_264(qmu_264, qmu_);
}

static void
Hacl_Impl_BignumQ_Mul_barrett_reduction__2(uint64_t *t, uint64_t *m1, uint64_t *tmp)
{
  uint64_t *qmul = tmp;
  uint64_t *r = tmp + (uint32_t)5U;
  uint64_t *qmu_264 = tmp + (uint32_t)20U;
  uint64_t *s = tmp + (uint32_t)25U;
  Hacl_Impl_BignumQ_Mul_mod_264(r, t);
  Hacl_Impl_BignumQ_Mul_low_mul_5(qmul, qmu_264, m1);
  Hacl_Impl_BignumQ_Mul_sub_mod_264(s, r, qmul);
}

static void Hacl_Impl_BignumQ_Mul_mul_modq(uint64_t *out, uint64_t *x, uint64_t *y)
{
  uint64_t z_[10U] = { 0U };
  KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)9U);
  {
    FStar_UInt128_uint128 z[9U];
    {
      uint32_t _i;
      for (_i = 0U; _i < (uint32_t)9U; ++_i)
        z[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
    }
    Hacl_Impl_BignumQ_Mul_mul_5(z, x, y);
    Hacl_Impl_BignumQ_Mul_carry(z_, z);
    {
      uint64_t tmp[40U] = { 0U };
      uint64_t *m1 = tmp;
      uint64_t *mu1 = tmp + (uint32_t)5U;
      uint64_t *tmp1 = tmp + (uint32_t)10U;
      uint64_t *s;
      Hacl_Impl_BignumQ_Mul_make_m(m1);
      Hacl_Impl_BignumQ_Mul_make_mu(mu1);
      s = tmp1 + (uint32_t)25U;
      KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)9U);
      {
        FStar_UInt128_uint128 qmu[9U];
        {
          uint32_t _i;
          for (_i = 0U; _i < (uint32_t)9U; ++_i)
            qmu[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
        }
        Hacl_Impl_BignumQ_Mul_barrett_reduction__1(qmu, z_, mu1, tmp1);
        Hacl_Impl_BignumQ_Mul_barrett_reduction__2(z_, m1, tmp1);
        Hacl_Impl_BignumQ_Mul_subm_conditional(out, s);
      }
    }
  }
}

static void Hacl_Impl_BignumQ_Mul_add_modq_(uint64_t *out, uint64_t *x, uint64_t *y)
{
  uint64_t tmp[5U] = { 0U };
  uint64_t x0 = x[0U];
  uint64_t x1 = x[1U];
  uint64_t x2 = x[2U];
  uint64_t x3 = x[3U];
  uint64_t x4 = x[4U];
  uint64_t y0 = y[0U];
  uint64_t y1 = y[1U];
  uint64_t y2 = y[2U];
  uint64_t y3 = y[3U];
  uint64_t y4 = y[4U];
  uint64_t z0 = x0 + y0;
  uint64_t z1 = x1 + y1;
  uint64_t z2 = x2 + y2;
  uint64_t z3 = x3 + y3;
  uint64_t z4 = x4 + y4;
  uint64_t x5 = z0;
  uint64_t y5 = z1;
  uint64_t carry1 = x5 >> (uint32_t)56U;
  uint64_t t = x5 & (uint64_t)0xffffffffffffffU;
  uint64_t x01 = t;
  uint64_t z1_ = y5 + carry1;
  uint64_t x6 = z1_;
  uint64_t y6 = z2;
  uint64_t carry2 = x6 >> (uint32_t)56U;
  uint64_t t1 = x6 & (uint64_t)0xffffffffffffffU;
  uint64_t x11 = t1;
  uint64_t z2_ = y6 + carry2;
  uint64_t x7 = z2_;
  uint64_t y7 = z3;
  uint64_t carry3 = x7 >> (uint32_t)56U;
  uint64_t t2 = x7 & (uint64_t)0xffffffffffffffU;
  uint64_t x21 = t2;
  uint64_t z3_ = y7 + carry3;
  uint64_t x8 = z3_;
  uint64_t y8 = z4;
  uint64_t carry4 = x8 >> (uint32_t)56U;
  uint64_t t3 = x8 & (uint64_t)0xffffffffffffffU;
  uint64_t x31 = t3;
  uint64_t x41 = y8 + carry4;
  tmp[0U] = x01;
  tmp[1U] = x11;
  tmp[2U] = x21;
  tmp[3U] = x31;
  tmp[4U] = x41;
  Hacl_Impl_BignumQ_Mul_subm_conditional(out, tmp);
}

static void Hacl_Impl_BignumQ_Mul_add_modq(uint64_t *out, uint64_t *x, uint64_t *y)
{
  Hacl_Impl_BignumQ_Mul_add_modq_(out, x, y);
}

static void
Hacl_Impl_SHA512_ModQ_sha512_modq_pre(
  uint64_t *out,
  uint8_t *prefix,
  uint8_t *input,
  uint32_t len1
)
{
  uint64_t tmp[10U] = { 0U };
  uint8_t hash1[64U] = { 0U };
  Hacl_Impl_Sha512_sha512_pre_msg(hash1, prefix, input, len1);
  Hacl_Impl_Load56_load_64_bytes(tmp, hash1);
  {
    uint64_t tmp1[40U] = { 0U };
    uint64_t *m1 = tmp1;
    uint64_t *mu1 = tmp1 + (uint32_t)5U;
    uint64_t *tmp2 = tmp1 + (uint32_t)10U;
    uint64_t *s;
    Hacl_Impl_BignumQ_Mul_make_m(m1);
    Hacl_Impl_BignumQ_Mul_make_mu(mu1);
    s = tmp2 + (uint32_t)25U;
    KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)9U);
    {
      FStar_UInt128_uint128 qmu[9U];
      {
        uint32_t _i;
        for (_i = 0U; _i < (uint32_t)9U; ++_i)
          qmu[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
      }
      Hacl_Impl_BignumQ_Mul_barrett_reduction__1(qmu, tmp, mu1, tmp2);
      Hacl_Impl_BignumQ_Mul_barrett_reduction__2(tmp, m1, tmp2);
      Hacl_Impl_BignumQ_Mul_subm_conditional(out, s);
    }
  }
}

static void
Hacl_Impl_SHA512_ModQ_sha512_modq_pre_pre2(
  uint64_t *out,
  uint8_t *prefix,
  uint8_t *prefix2,
  uint8_t *input,
  uint32_t len1
)
{
  uint64_t tmp[10U] = { 0U };
  uint8_t hash1[64U] = { 0U };
  Hacl_Impl_Sha512_sha512_pre_pre2_msg(hash1, prefix, prefix2, input, len1);
  Hacl_Impl_Load56_load_64_bytes(tmp, hash1);
  {
    uint64_t tmp1[40U] = { 0U };
    uint64_t *m1 = tmp1;
    uint64_t *mu1 = tmp1 + (uint32_t)5U;
    uint64_t *tmp2 = tmp1 + (uint32_t)10U;
    uint64_t *s;
    Hacl_Impl_BignumQ_Mul_make_m(m1);
    Hacl_Impl_BignumQ_Mul_make_mu(mu1);
    s = tmp2 + (uint32_t)25U;
    KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)9U);
    {
      FStar_UInt128_uint128 qmu[9U];
      {
        uint32_t _i;
        for (_i = 0U; _i < (uint32_t)9U; ++_i)
          qmu[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
      }
      Hacl_Impl_BignumQ_Mul_barrett_reduction__1(qmu, tmp, mu1, tmp2);
      Hacl_Impl_BignumQ_Mul_barrett_reduction__2(tmp, m1, tmp2);
      Hacl_Impl_BignumQ_Mul_subm_conditional(out, s);
    }
  }
}

static void Hacl_Impl_Ed25519_PointDouble_point_double_step_1(uint64_t *p10, uint64_t *tmp)
{
  uint64_t *tmp1 = tmp;
  uint64_t *tmp2 = tmp + (uint32_t)5U;
  uint64_t *tmp3 = tmp + (uint32_t)10U;
  uint64_t *tmp4 = tmp + (uint32_t)15U;
  uint64_t *x1 = Hacl_Impl_Ed25519_ExtPoint_getx(p10);
  uint64_t *y1 = Hacl_Impl_Ed25519_ExtPoint_gety(p10);
  uint64_t *z1 = Hacl_Impl_Ed25519_ExtPoint_getz(p10);
  KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)5U);
  {
    FStar_UInt128_uint128 tmp7[5U];
    {
      uint32_t _i;
      for (_i = 0U; _i < (uint32_t)5U; ++_i)
        tmp7[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
    }
    memcpy(tmp1, x1, (uint32_t)5U * sizeof x1[0U]);
    Hacl_Bignum_Fsquare_fsquare_(tmp7, tmp1);
    KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)5U);
    {
      FStar_UInt128_uint128 tmp70[5U];
      {
        uint32_t _i;
        for (_i = 0U; _i < (uint32_t)5U; ++_i)
          tmp70[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
      }
      memcpy(tmp2, y1, (uint32_t)5U * sizeof y1[0U]);
      Hacl_Bignum_Fsquare_fsquare_(tmp70, tmp2);
      KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)5U);
      {
        FStar_UInt128_uint128 tmp71[5U];
        {
          uint32_t _i;
          for (_i = 0U; _i < (uint32_t)5U; ++_i)
            tmp71[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
        }
        {
          uint64_t a0;
          uint64_t a1;
          uint64_t a2;
          uint64_t a3;
          uint64_t a4;
          uint64_t o0;
          uint64_t o1;
          uint64_t o2;
          uint64_t o3;
          uint64_t o4;
          uint64_t t0;
          uint64_t t1;
          uint64_t t2;
          uint64_t t3;
          uint64_t t4;
          uint64_t t1_;
          uint64_t t0_;
          uint64_t t2_;
          uint64_t t1__;
          uint64_t t3_;
          uint64_t t2__;
          uint64_t t4_;
          uint64_t t3__;
          uint64_t i0;
          uint64_t i1;
          uint64_t i0_;
          uint64_t i1_;
          memcpy(tmp3, z1, (uint32_t)5U * sizeof z1[0U]);
          Hacl_Bignum_Fsquare_fsquare_(tmp71, tmp3);
          a0 = tmp3[0U];
          a1 = tmp3[1U];
          a2 = tmp3[2U];
          a3 = tmp3[3U];
          a4 = tmp3[4U];
          o0 = (uint64_t)2U * a0;
          o1 = (uint64_t)2U * a1;
          o2 = (uint64_t)2U * a2;
          o3 = (uint64_t)2U * a3;
          o4 = (uint64_t)2U * a4;
          tmp4[0U] = o0;
          tmp4[1U] = o1;
          tmp4[2U] = o2;
          tmp4[3U] = o3;
          tmp4[4U] = o4;
          memcpy(tmp3, tmp1, (uint32_t)5U * sizeof tmp1[0U]);
          Hacl_Bignum_fsum(tmp3, tmp2);
          t0 = tmp3[0U];
          t1 = tmp3[1U];
          t2 = tmp3[2U];
          t3 = tmp3[3U];
          t4 = tmp3[4U];
          t1_ = t1 + (t0 >> (uint32_t)51U);
          t0_ = t0 & (uint64_t)0x7ffffffffffffU;
          t2_ = t2 + (t1_ >> (uint32_t)51U);
          t1__ = t1_ & (uint64_t)0x7ffffffffffffU;
          t3_ = t3 + (t2_ >> (uint32_t)51U);
          t2__ = t2_ & (uint64_t)0x7ffffffffffffU;
          t4_ = t4 + (t3_ >> (uint32_t)51U);
          t3__ = t3_ & (uint64_t)0x7ffffffffffffU;
          tmp3[0U] = t0_;
          tmp3[1U] = t1__;
          tmp3[2U] = t2__;
          tmp3[3U] = t3__;
          tmp3[4U] = t4_;
          Hacl_Bignum_Modulo_carry_top(tmp3);
          i0 = tmp3[0U];
          i1 = tmp3[1U];
          i0_ = i0 & (uint64_t)0x7ffffffffffffU;
          i1_ = i1 + (i0 >> (uint32_t)51U);
          tmp3[0U] = i0_;
          tmp3[1U] = i1_;
        }
      }
    }
  }
}

static void
Hacl_Impl_Ed25519_PointDouble_point_double_(uint64_t *out, uint64_t *p10, uint64_t *tmp)
{
  uint64_t *tmp2 = tmp + (uint32_t)5U;
  uint64_t *tmp3 = tmp + (uint32_t)10U;
  uint64_t *tmp4 = tmp + (uint32_t)15U;
  uint64_t *tmp6 = tmp + (uint32_t)25U;
  uint64_t *x3 = Hacl_Impl_Ed25519_ExtPoint_getx(out);
  uint64_t *y3 = Hacl_Impl_Ed25519_ExtPoint_gety(out);
  uint64_t *z3 = Hacl_Impl_Ed25519_ExtPoint_getz(out);
  uint64_t *t3 = Hacl_Impl_Ed25519_ExtPoint_gett(out);
  uint64_t *tmp11;
  uint64_t *tmp21;
  uint64_t *tmp31;
  uint64_t *tmp41;
  uint64_t *tmp51;
  uint64_t *tmp61;
  uint64_t *x1;
  uint64_t *y1;
  Hacl_Impl_Ed25519_PointDouble_point_double_step_1(p10, tmp);
  tmp11 = tmp;
  tmp21 = tmp + (uint32_t)5U;
  tmp31 = tmp + (uint32_t)10U;
  tmp41 = tmp + (uint32_t)15U;
  tmp51 = tmp + (uint32_t)20U;
  tmp61 = tmp + (uint32_t)25U;
  x1 = Hacl_Impl_Ed25519_ExtPoint_getx(p10);
  y1 = Hacl_Impl_Ed25519_ExtPoint_gety(p10);
  memcpy(tmp51, x1, (uint32_t)5U * sizeof x1[0U]);
  Hacl_Bignum_fsum(tmp51, y1);
  KRML_CHECK_SIZE(sizeof (FStar_UInt128_uint128), (uint32_t)5U);
  {
    FStar_UInt128_uint128 tmp7[5U];
    {
      uint32_t _i;
      for (_i = 0U; _i < (uint32_t)5U; ++_i)
        tmp7[_i] = FStar_UInt128_uint64_to_uint128((uint64_t)0U);
    }
    {
      uint64_t t00;
      uint64_t t10;
      uint64_t t20;
      uint64_t t310;
      uint64_t t40;
      uint64_t t1_;
      uint64_t t0_;
      uint64_t t2_;
      uint64_t t1__;
      uint64_t t3_;
      uint64_t t2__;
      uint64_t t4_;
      uint64_t t3__;
      uint64_t i00;
      uint64_t i10;
      uint64_t i0_;
      uint64_t i1_;
      uint64_t t0;
      uint64_t t1;
      uint64_t t2;
      uint64_t t31;
      uint64_t t4;
      uint64_t t1_0;
      uint64_t t0_0;
      uint64_t t2_0;
      uint64_t t1__0;
      uint64_t t3_0;
      uint64_t t2__0;
      uint64_t t4_0;
      uint64_t t3__0;
      uint64_t i0;
      uint64_t i1;
      uint64_t i0_0;
      uint64_t i1_0;
      memcpy(tmp61, tmp51, (uint32_t)5U * sizeof tmp51[0U]);
      Hacl_Bignum_Fsquare_fsquare_(tmp7, tmp61);
      memcpy(tmp51, tmp31, (uint32_t)5U * sizeof tmp31[0U]);
      Hacl_Bignum_fdifference(tmp61, tmp51);
      Hacl_Bignum_fdifference(tmp21, tmp11);
      t00 = tmp21[0U];
      t10 = tmp21[1U];
      t20 = tmp21[2U];
      t310 = tmp21[3U];
      t40 = tmp21[4U];
      t1_ = t10 + (t00 >> (uint32_t)51U);
      t0_ = t00 & (uint64_t)0x7ffffffffffffU;
      t2_ = t20 + (t1_ >> (uint32_t)51U);
      t1__ = t1_ & (uint64_t)0x7ffffffffffffU;
      t3_ = t310 + (t2_ >> (uint32_t)51U);
      t2__ = t2_ & (uint64_t)0x7ffffffffffffU;
      t4_ = t40 + (t3_ >> (uint32_t)51U);
      t3__ = t3_ & (uint64_t)0x7ffffffffffffU;
      tmp21[0U] = t0_;
      tmp21[1U] = t1__;
      tmp21[2U] = t2__;
      tmp21[3U] = t3__;
      tmp21[4U] = t4_;
      Hacl_Bignum_Modulo_carry_top(tmp21);
      i00 = tmp21[0U];
      i10 = tmp21[1U];
      i0_ = i00 & (uint64_t)0x7ffffffffffffU;
      i1_ = i10 + (i00 >> (uint32_t)51U);
      tmp21[0U] = i0_;
      tmp21[1U] = i1_;
      t0 = tmp41[0U];
      t1 = tmp41[1U];
      t2 = tmp41[2U];
      t31 = tmp41[3U];
      t4 = tmp41[4U];
      t1_0 = t1 + (t0 >> (uint32_t)51U);
      t0_0 = t0 & (uint64_t)0x7ffffffffffffU;
      t2_0 = t2 + (t1_0 >> (uint32_t)51U);
      t1__0 = t1_0 & (uint64_t)0x7ffffffffffffU;
      t3_0 = t31 + (t2_0 >> (uint32_t)51U);
      t2__0 = t2_0 & (uint64_t)0x7ffffffffffffU;
      t4_0 = t4 + (t3_0 >> (uint32_t)51U);
      t3__0 = t3_0 & (uint64_t)0x7ffffffffffffU;
      tmp41[0U] = t0_0;
      tmp41[1U] = t1__0;
      tmp41[2U] = t2__0;
      tmp41[3U] = t3__0;
      tmp41[4U] = t4_0;
      Hacl_Bignum_Modulo_carry_top(tmp41);
      i0 = tmp41[0U];
      i1 = tmp41[1U];
      i0_0 = i0 & (uint64_t)0x7ffffffffffffU;
      i1_0 = i1 + (i0 >> (uint32_t)51U);
      tmp41[0U] = i0_0;
      tmp41[1U] = i1_0;
      Hacl_Bignum_fsum(tmp41, tmp21);
      Hacl_Bignum_fmul(x3, tmp4, tmp6);
      Hacl_Bignum_fmul(y3, tmp2, tmp3);
      Hacl_Bignum_fmul(t3, tmp3, tmp6);
      Hacl_Bignum_fmul(z3, tmp4, tmp2);
    }
  }
}

static void Hacl_Impl_Ed25519_PointDouble_point_double(uint64_t *out, uint64_t *p10)
{
  uint64_t tmp[30U] = { 0U };
  Hacl_Impl_Ed25519_PointDouble_point_double_(out, p10, tmp);
}

static void
Hacl_Impl_Ed25519_SwapConditional_swap_conditional_step(
  uint64_t *a_,
  uint64_t *b_,
  uint64_t *a,
  uint64_t *b,
  uint64_t swap1
)
{
  uint64_t a0 = a[0U];
  uint64_t a1 = a[1U];
  uint64_t a2 = a[2U];
  uint64_t a3 = a[3U];
  uint64_t a4 = a[4U];
  uint64_t b0 = b[0U];
  uint64_t b1 = b[1U];
  uint64_t b2 = b[2U];
  uint64_t b3 = b[3U];
  uint64_t b4 = b[4U];
  uint64_t x0 = swap1 & (a0 ^ b0);
  uint64_t x1 = swap1 & (a1 ^ b1);
  uint64_t x2 = swap1 & (a2 ^ b2);
  uint64_t x3 = swap1 & (a3 ^ b3);
  uint64_t x4 = swap1 & (a4 ^ b4);
  uint64_t a0_ = a0 ^ x0;
  uint64_t b0_ = b0 ^ x0;
  uint64_t a1_ = a1 ^ x1;
  uint64_t b1_ = b1 ^ x1;
  uint64_t a2_ = a2 ^ x2;
  uint64_t b2_ = b2 ^ x2;
  uint64_t a3_ = a3 ^ x3;
  uint64_t b3_ = b3 ^ x3;
  uint64_t a4_ = a4 ^ x4;
  uint64_t b4_ = b4 ^ x4;
  a_[0U] = a0_;
  a_[1U] = a1_;
  a_[2U] = a2_;
  a_[3U] = a3_;
  a_[4U] = a4_;
  b_[0U] = b0_;
  b_[1U] = b1_;
  b_[2U] = b2_;
  b_[3U] = b3_;
  b_[4U] = b4_;
}

static void
Hacl_Impl_Ed25519_SwapConditional_swap_conditional(
  uint64_t *a_,
  uint64_t *b_,
  uint64_t *a,
  uint64_t *b,
  uint64_t iswap
)
{
  uint64_t swap1 = (uint64_t)0U - iswap;
  Hacl_Impl_Ed25519_SwapConditional_swap_conditional_step(Hacl_Impl_Ed25519_ExtPoint_getx(a_),
    Hacl_Impl_Ed25519_ExtPoint_getx(b_),
    Hacl_Impl_Ed25519_ExtPoint_getx(a),
    Hacl_Impl_Ed25519_ExtPoint_getx(b),
    swap1);
  Hacl_Impl_Ed25519_SwapConditional_swap_conditional_step(Hacl_Impl_Ed25519_ExtPoint_gety(a_),
    Hacl_Impl_Ed25519_ExtPoint_gety(b_),
    Hacl_Impl_Ed25519_ExtPoint_gety(a),
    Hacl_Impl_Ed25519_ExtPoint_gety(b),
    swap1);
  Hacl_Impl_Ed25519_SwapConditional_swap_conditional_step(Hacl_Impl_Ed25519_ExtPoint_getz(a_),
    Hacl_Impl_Ed25519_ExtPoint_getz(b_),
    Hacl_Impl_Ed25519_ExtPoint_getz(a),
    Hacl_Impl_Ed25519_ExtPoint_getz(b),
    swap1);
  Hacl_Impl_Ed25519_SwapConditional_swap_conditional_step(Hacl_Impl_Ed25519_ExtPoint_gett(a_),
    Hacl_Impl_Ed25519_ExtPoint_gett(b_),
    Hacl_Impl_Ed25519_ExtPoint_gett(a),
    Hacl_Impl_Ed25519_ExtPoint_gett(b),
    swap1);
}

static void
Hacl_Impl_Ed25519_SwapConditional_swap_conditional_inplace(
  uint64_t *a,
  uint64_t *b,
  uint64_t iswap
)
{
  uint64_t swap1 = (uint64_t)0U - iswap;
  Hacl_Impl_Ed25519_SwapConditional_swap_conditional_step(Hacl_Impl_Ed25519_ExtPoint_getx(a),
    Hacl_Impl_Ed25519_ExtPoint_getx(b),
    Hacl_Impl_Ed25519_ExtPoint_getx(a),
    Hacl_Impl_Ed25519_ExtPoint_getx(b),
    swap1);
  Hacl_Impl_Ed25519_SwapConditional_swap_conditional_step(Hacl_Impl_Ed25519_ExtPoint_gety(a),
    Hacl_Impl_Ed25519_ExtPoint_gety(b),
    Hacl_Impl_Ed25519_ExtPoint_gety(a),
    Hacl_Impl_Ed25519_ExtPoint_gety(b),
    swap1);
  Hacl_Impl_Ed25519_SwapConditional_swap_conditional_step(Hacl_Impl_Ed25519_ExtPoint_getz(a),
    Hacl_Impl_Ed25519_ExtPoint_getz(b),
    Hacl_Impl_Ed25519_ExtPoint_getz(a),
    Hacl_Impl_Ed25519_ExtPoint_getz(b),
    swap1);
  Hacl_Impl_Ed25519_SwapConditional_swap_conditional_step(Hacl_Impl_Ed25519_ExtPoint_gett(a),
    Hacl_Impl_Ed25519_ExtPoint_gett(b),
    Hacl_Impl_Ed25519_ExtPoint_gett(a),
    Hacl_Impl_Ed25519_ExtPoint_gett(b),
    swap1);
}

static void Hacl_Impl_Ed25519_SwapConditional_copy(uint64_t *output, uint64_t *input)
{
  memcpy(output, input, (uint32_t)20U * sizeof input[0U]);
}

static void Hacl_Impl_Ed25519_Ladder_Step_loop_step(uint64_t *b, uint8_t *k1, uint32_t ctr)
{
  uint32_t q1 = ctr >> (uint32_t)3U;
  uint32_t r = ctr & (uint32_t)7U;
  uint8_t kq = k1[q1];
  uint8_t kq_ = kq >> r;
  uint8_t bit = kq_ & (uint8_t)1U;
  uint64_t *nq10 = b;
  uint64_t *nqpq10 = b + (uint32_t)20U;
  uint64_t bit10 = (uint64_t)bit;
  uint64_t *nq11;
  uint64_t *nqpq11;
  uint64_t *nq210;
  uint64_t *nqpq210;
  Hacl_Impl_Ed25519_SwapConditional_swap_conditional_inplace(nq10, nqpq10, bit10);
  nq11 = b;
  nqpq11 = b + (uint32_t)20U;
  nq210 = b + (uint32_t)40U;
  nqpq210 = b + (uint32_t)60U;
  Hacl_Impl_Ed25519_PointDouble_point_double(nq210, nq11);
  {
    uint64_t tmp[30U] = { 0U };
    uint64_t *tmp10 = tmp;
    uint64_t *tmp20 = tmp + (uint32_t)5U;
    uint64_t *tmp30 = tmp + (uint32_t)10U;
    uint64_t *tmp40 = tmp + (uint32_t)15U;
    uint64_t *x1 = Hacl_Impl_Ed25519_ExtPoint_getx(nq11);
    uint64_t *y1 = Hacl_Impl_Ed25519_ExtPoint_gety(nq11);
    uint64_t *x2 = Hacl_Impl_Ed25519_ExtPoint_getx(nqpq11);
    uint64_t *y2 = Hacl_Impl_Ed25519_ExtPoint_gety(nqpq11);
    uint64_t t00;
    uint64_t t10;
    uint64_t t20;
    uint64_t t30;
    uint64_t t40;
    uint64_t t1_;
    uint64_t t0_;
    uint64_t t2_;
    uint64_t t1__;
    uint64_t t3_;
    uint64_t t2__;
    uint64_t t4_;
    uint64_t t3__;
    uint64_t i00;
    uint64_t i10;
    uint64_t i0_;
    uint64_t i1_;
    uint64_t *tmp11;
    uint64_t *tmp21;
    uint64_t *tmp31;
    uint64_t *tmp50;
    uint64_t *tmp60;
    uint64_t *z1;
    uint64_t *t11;
    uint64_t *z2;
    uint64_t *t21;
    memcpy(tmp10, x1, (uint32_t)5U * sizeof x1[0U]);
    memcpy(tmp20, x2, (uint32_t)5U * sizeof x2[0U]);
    Hacl_Bignum_fdifference(tmp10, y1);
    t00 = tmp10[0U];
    t10 = tmp10[1U];
    t20 = tmp10[2U];
    t30 = tmp10[3U];
    t40 = tmp10[4U];
    t1_ = t10 + (t00 >> (uint32_t)51U);
    t0_ = t00 & (uint64_t)0x7ffffffffffffU;
    t2_ = t20 + (t1_ >> (uint32_t)51U);
    t1__ = t1_ & (uint64_t)0x7ffffffffffffU;
    t3_ = t30 + (t2_ >> (uint32_t)51U);
    t2__ = t2_ & (uint64_t)0x7ffffffffffffU;
    t4_ = t40 + (t3_ >> (uint32_t)51U);
    t3__ = t3_ & (uint64_t)0x7ffffffffffffU;
    tmp10[0U] = t0_;
    tmp10[1U] = t1__;
    tmp10[2U] = t2__;
    tmp10[3U] = t3__;
    tmp10[4U] = t4_;
    Hacl_Bignum_Modulo_carry_top(tmp10);
    i00 = tmp10[0U];
    i10 = tmp10[1U];
    i0_ = i00 & (uint64_t)0x7ffffffffffffU;
    i1_ = i10 + (i00 >> (uint32_t)51U);
    tmp10[0U] = i0_;
    tmp10[1U] = i1_;
    Hacl_Bignum_fdifference(tmp20, y2);
    Hacl_Bignum_fmul(tmp30, tmp10, tmp20);
    memcpy(tmp10, y1, (uint32_t)5U * sizeof y1[0U]);
    memcpy(tmp20, y2, (uint32_t)5U * sizeof y2[0U]);
    Hacl_Bignum_fsum(tmp10, x1);
    Hacl_Bignum_fsum(tmp20, x2);
    Hacl_Bignum_fmul(tmp40, tmp10, tmp20);
    tmp11 = tmp;
    tmp21 = tmp + (uint32_t)5U;
    tmp31 = tmp + (uint32_t)10U;
    tmp50 = tmp + (uint32_t)20U;
    tmp60 = tmp + (uint32_t)25U;
    z1 = Hacl_Impl_Ed25519_ExtPoint_getz(nq11);
    t11 = Hacl_Impl_Ed25519_ExtPoint_gett(nq11);
    z2 = Hacl_Impl_Ed25519_ExtPoint_getz(nqpq11);
    t21 = Hacl_Impl_Ed25519_ExtPoint_gett(nqpq11);
    {
      uint64_t d2[5U] = { 0U };
      uint64_t a0;
      uint64_t a1;
      uint64_t a2;
      uint64_t a3;
      uint64_t a4;
      uint64_t o0;
      uint64_t o1;
      uint64_t o2;
      uint64_t o3;
      uint64_t o4;
      uint64_t *tmp12;
      uint64_t *tmp2;
      uint64_t *tmp3;
      uint64_t *tmp41;
      uint64_t *tmp51;
      uint64_t *tmp61;
      uint64_t t0;
      uint64_t t1;
      uint64_t t2;
      uint64_t t31;
      uint64_t t4;
      uint64_t t1_0;
      uint64_t t0_0;
      uint64_t t2_0;
      uint64_t t1__0;
      uint64_t t3_0;
      uint64_t t2__0;
      uint64_t t4_0;
      uint64_t t3__0;
      uint64_t i0;
      uint64_t i1;
      uint64_t i0_0;
      uint64_t i1_0;
      uint64_t *tmp1;
      uint64_t *tmp4;
      uint64_t *tmp5;
      uint64_t *tmp6;
      uint64_t *x3;
      uint64_t *y3;
      uint64_t *z3;
      uint64_t *t3;
      uint64_t *nq1;
      uint64_t *nqpq1;
      uint64_t *nq21;
      uint64_t *nqpq21;
      uint64_t bit1;
      d2[0U] = (uint64_t)0x00069b9426b2f159U;
      d2[1U] = (uint64_t)0x00035050762add7aU;
      d2[2U] = (uint64_t)0x0003cf44c0038052U;
      d2[3U] = (uint64_t)0x0006738cc7407977U;
      d2[4U] = (uint64_t)0x0002406d9dc56dffU;
      Hacl_Bignum_fmul(tmp11, t11, d2);
      Hacl_Bignum_fmul(tmp21, tmp11, t21);
      a0 = z1[0U];
      a1 = z1[1U];
      a2 = z1[2U];
      a3 = z1[3U];
      a4 = z1[4U];
      o0 = (uint64_t)2U * a0;
      o1 = (uint64_t)2U * a1;
      o2 = (uint64_t)2U * a2;
      o3 = (uint64_t)2U * a3;
      o4 = (uint64_t)2U * a4;
      tmp11[0U] = o0;
      tmp11[1U] = o1;
      tmp11[2U] = o2;
      tmp11[3U] = o3;
      tmp11[4U] = o4;
      Hacl_Bignum_fmul(tmp50, tmp11, z2);
      memcpy(tmp11, tmp31, (uint32_t)5U * sizeof tmp31[0U]);
      memcpy(tmp60, tmp21, (uint32_t)5U * sizeof tmp21[0U]);
      tmp12 = tmp;
      tmp2 = tmp + (uint32_t)5U;
      tmp3 = tmp + (uint32_t)10U;
      tmp41 = tmp + (uint32_t)15U;
      tmp51 = tmp + (uint32_t)20U;
      tmp61 = tmp + (uint32_t)25U;
      Hacl_Bignum_fdifference(tmp12, tmp41);
      t0 = tmp12[0U];
      t1 = tmp12[1U];
      t2 = tmp12[2U];
      t31 = tmp12[3U];
      t4 = tmp12[4U];
      t1_0 = t1 + (t0 >> (uint32_t)51U);
      t0_0 = t0 & (uint64_t)0x7ffffffffffffU;
      t2_0 = t2 + (t1_0 >> (uint32_t)51U);
      t1__0 = t1_0 & (uint64_t)0x7ffffffffffffU;
      t3_0 = t31 + (t2_0 >> (uint32_t)51U);
      t2__0 = t2_0 & (uint64_t)0x7ffffffffffffU;
      t4_0 = t4 + (t3_0 >> (uint32_t)51U);
      t3__0 = t3_0 & (uint64_t)0x7ffffffffffffU;
      tmp12[0U] = t0_0;
      tmp12[1U] = t1__0;
      tmp12[2U] = t2__0;
      tmp12[3U] = t3__0;
      tmp12[4U] = t4_0;
      Hacl_Bignum_Modulo_carry_top(tmp12);
      i0 = tmp12[0U];
      i1 = tmp12[1U];
      i0_0 = i0 & (uint64_t)0x7ffffffffffffU;
      i1_0 = i1 + (i0 >> (uint32_t)51U);
      tmp12[0U] = i0_0;
      tmp12[1U] = i1_0;
      Hacl_Bignum_fdifference(tmp61, tmp51);
      Hacl_Bignum_fsum(tmp51, tmp2);
      Hacl_Bignum_fsum(tmp41, tmp3);
      tmp1 = tmp;
      tmp4 = tmp + (uint32_t)15U;
      tmp5 = tmp + (uint32_t)20U;
      tmp6 = tmp + (uint32_t)25U;
      x3 = Hacl_Impl_Ed25519_ExtPoint_getx(nqpq210);
      y3 = Hacl_Impl_Ed25519_ExtPoint_gety(nqpq210);
      z3 = Hacl_Impl_Ed25519_ExtPoint_getz(nqpq210);
      t3 = Hacl_Impl_Ed25519_ExtPoint_gett(nqpq210);
      Hacl_Bignum_fmul(x3, tmp1, tmp6);
      Hacl_Bignum_fmul(y3, tmp5, tmp4);
      Hacl_Bignum_fmul(t3, tmp1, tmp4);
      Hacl_Bignum_fmul(z3, tmp5, tmp6);
      nq1 = b;
      nqpq1 = b + (uint32_t)20U;
      nq21 = b + (uint32_t)40U;
      nqpq21 = b + (uint32_t)60U;
      bit1 = (uint64_t)bit;
      Hacl_Impl_Ed25519_SwapConditional_swap_conditional(nq1, nqpq1, nq21, nqpq21, bit1);
    }
  }
}

static void Hacl_Impl_Ed25519_Ladder_point_mul_(uint64_t *b, uint8_t *k1)
{
  uint32_t i;
  for (i = (uint32_t)0U; i < (uint32_t)256U; i = i + (uint32_t)1U)
  {
    Hacl_Impl_Ed25519_Ladder_Step_loop_step(b, k1, (uint32_t)256U - i - (uint32_t)1U);
  }
}

static void Hacl_Impl_Ed25519_Ladder_point_mul(uint64_t *result, uint8_t *scalar, uint64_t *q1)
{
  uint64_t b[80U] = { 0U };
  uint64_t *nq = b;
  uint64_t *nqpq = b + (uint32_t)20U;
  uint64_t *x = nq;
  uint64_t *y = nq + (uint32_t)5U;
  uint64_t *z = nq + (uint32_t)10U;
  uint64_t *t = nq + (uint32_t)15U;
  uint64_t zero10 = (uint64_t)0U;
  uint64_t zero11;
  uint64_t one10;
  uint64_t zero12;
  uint64_t one1;
  uint64_t zero1;
  x[0U] = zero10;
  x[1U] = zero10;
  x[2U] = zero10;
  x[3U] = zero10;
  x[4U] = zero10;
  zero11 = (uint64_t)0U;
  one10 = (uint64_t)1U;
  y[0U] = one10;
  y[1U] = zero11;
  y[2U] = zero11;
  y[3U] = zero11;
  y[4U] = zero11;
  zero12 = (uint64_t)0U;
  one1 = (uint64_t)1U;
  z[0U] = one1;
  z[1U] = zero12;
  z[2U] = zero12;
  z[3U] = zero12;
  z[4U] = zero12;
  zero1 = (uint64_t)0U;
  t[0U] = zero1;
  t[1U] = zero1;
  t[2U] = zero1;
  t[3U] = zero1;
  t[4U] = zero1;
  Hacl_Impl_Ed25519_SwapConditional_copy(nqpq, q1);
  Hacl_Impl_Ed25519_Ladder_point_mul_(b, scalar);
  Hacl_Impl_Ed25519_SwapConditional_copy(result, nq);
}

static bool Hacl_Impl_Ed25519_Verify_Steps_verify_step_1(uint64_t *r_, uint8_t *signature)
{
  uint8_t *rs = signature;
  bool b_ = Hacl_Impl_Ed25519_PointDecompress_point_decompress(r_, rs);
  return b_;
}

static void
Hacl_Impl_Ed25519_Verify_Steps_verify_step_2(
  uint8_t *r,
  uint8_t *msg,
  uint32_t len1,
  uint8_t *rs,
  uint8_t *public
)
{
  uint64_t r_[5U] = { 0U };
  Hacl_Impl_SHA512_ModQ_sha512_modq_pre_pre2(r_, rs, public, msg, len1);
  Hacl_Impl_Store56_store_56(r, r_);
}

static void Hacl_Impl_Ed25519_Verify_Steps_point_mul_g(uint64_t *result, uint8_t *scalar)
{
  uint64_t g1[20U] = { 0U };
  uint64_t *gx = Hacl_Impl_Ed25519_ExtPoint_getx(g1);
  uint64_t *gy = Hacl_Impl_Ed25519_ExtPoint_gety(g1);
  uint64_t *gz = Hacl_Impl_Ed25519_ExtPoint_getz(g1);
  uint64_t *gt1 = Hacl_Impl_Ed25519_ExtPoint_gett(g1);
  gx[0U] = (uint64_t)0x00062d608f25d51aU;
  gx[1U] = (uint64_t)0x000412a4b4f6592aU;
  gx[2U] = (uint64_t)0x00075b7171a4b31dU;
  gx[3U] = (uint64_t)0x0001ff60527118feU;
  gx[4U] = (uint64_t)0x000216936d3cd6e5U;
  gy[0U] = (uint64_t)0x0006666666666658U;
  gy[1U] = (uint64_t)0x0004ccccccccccccU;
  gy[2U] = (uint64_t)0x0001999999999999U;
  gy[3U] = (uint64_t)0x0003333333333333U;
  gy[4U] = (uint64_t)0x0006666666666666U;
  gz[0U] = (uint64_t)0x0000000000000001U;
  gz[1U] = (uint64_t)0x0000000000000000U;
  gz[2U] = (uint64_t)0x0000000000000000U;
  gz[3U] = (uint64_t)0x0000000000000000U;
  gz[4U] = (uint64_t)0x0000000000000000U;
  gt1[0U] = (uint64_t)0x00068ab3a5b7dda3U;
  gt1[1U] = (uint64_t)0x00000eea2a5eadbbU;
  gt1[2U] = (uint64_t)0x0002af8df483c27eU;
  gt1[3U] = (uint64_t)0x000332b375274732U;
  gt1[4U] = (uint64_t)0x00067875f0fd78b7U;
  Hacl_Impl_Ed25519_Ladder_point_mul(result, scalar, g1);
}

static bool
Hacl_Impl_Ed25519_Verify_Steps_verify_step_4(
  uint8_t *s,
  uint8_t *h_,
  uint64_t *a_,
  uint64_t *r_
)
{
  uint64_t tmp[60U] = { 0U };
  uint64_t *hA = tmp;
  uint64_t *rhA = tmp + (uint32_t)20U;
  uint64_t *sB = tmp + (uint32_t)40U;
  Hacl_Impl_Ed25519_Verify_Steps_point_mul_g(sB, s);
  Hacl_Impl_Ed25519_Ladder_point_mul(hA, h_, a_);
  {
    uint64_t tmp1[30U] = { 0U };
    uint64_t *tmp110 = tmp1;
    uint64_t *tmp20 = tmp1 + (uint32_t)5U;
    uint64_t *tmp30 = tmp1 + (uint32_t)10U;
    uint64_t *tmp40 = tmp1 + (uint32_t)15U;
    uint64_t *x1 = Hacl_Impl_Ed25519_ExtPoint_getx(r_);
    uint64_t *y1 = Hacl_Impl_Ed25519_ExtPoint_gety(r_);
    uint64_t *x2 = Hacl_Impl_Ed25519_ExtPoint_getx(hA);
    uint64_t *y2 = Hacl_Impl_Ed25519_ExtPoint_gety(hA);
    uint64_t t00;
    uint64_t t10;
    uint64_t t20;
    uint64_t t30;
    uint64_t t40;
    uint64_t t1_;
    uint64_t t0_;
    uint64_t t2_;
    uint64_t t1__;
    uint64_t t3_;
    uint64_t t2__;
    uint64_t t4_;
    uint64_t t3__;
    uint64_t i00;
    uint64_t i10;
    uint64_t i0_;
    uint64_t i1_;
    uint64_t *tmp111;
    uint64_t *tmp21;
    uint64_t *tmp31;
    uint64_t *tmp50;
    uint64_t *tmp60;
    uint64_t *z1;
    uint64_t *t11;
    uint64_t *z2;
    uint64_t *t21;
    memcpy(tmp110, x1, (uint32_t)5U * sizeof x1[0U]);
    memcpy(tmp20, x2, (uint32_t)5U * sizeof x2[0U]);
    Hacl_Bignum_fdifference(tmp110, y1);
    t00 = tmp110[0U];
    t10 = tmp110[1U];
    t20 = tmp110[2U];
    t30 = tmp110[3U];
    t40 = tmp110[4U];
    t1_ = t10 + (t00 >> (uint32_t)51U);
    t0_ = t00 & (uint64_t)0x7ffffffffffffU;
    t2_ = t20 + (t1_ >> (uint32_t)51U);
    t1__ = t1_ & (uint64_t)0x7ffffffffffffU;
    t3_ = t30 + (t2_ >> (uint32_t)51U);
    t2__ = t2_ & (uint64_t)0x7ffffffffffffU;
    t4_ = t40 + (t3_ >> (uint32_t)51U);
    t3__ = t3_ & (uint64_t)0x7ffffffffffffU;
    tmp110[0U] = t0_;
    tmp110[1U] = t1__;
    tmp110[2U] = t2__;
    tmp110[3U] = t3__;
    tmp110[4U] = t4_;
    Hacl_Bignum_Modulo_carry_top(tmp110);
    i00 = tmp110[0U];
    i10 = tmp110[1U];
    i0_ = i00 & (uint64_t)0x7ffffffffffffU;
    i1_ = i10 + (i00 >> (uint32_t)51U);
    tmp110[0U] = i0_;
    tmp110[1U] = i1_;
    Hacl_Bignum_fdifference(tmp20, y2);
    Hacl_Bignum_fmul(tmp30, tmp110, tmp20);
    memcpy(tmp110, y1, (uint32_t)5U * sizeof y1[0U]);
    memcpy(tmp20, y2, (uint32_t)5U * sizeof y2[0U]);
    Hacl_Bignum_fsum(tmp110, x1);
    Hacl_Bignum_fsum(tmp20, x2);
    Hacl_Bignum_fmul(tmp40, tmp110, tmp20);
    tmp111 = tmp1;
    tmp21 = tmp1 + (uint32_t)5U;
    tmp31 = tmp1 + (uint32_t)10U;
    tmp50 = tmp1 + (uint32_t)20U;
    tmp60 = tmp1 + (uint32_t)25U;
    z1 = Hacl_Impl_Ed25519_ExtPoint_getz(r_);
    t11 = Hacl_Impl_Ed25519_ExtPoint_gett(r_);
    z2 = Hacl_Impl_Ed25519_ExtPoint_getz(hA);
    t21 = Hacl_Impl_Ed25519_ExtPoint_gett(hA);
    {
      uint64_t d2[5U] = { 0U };
      uint64_t a0;
      uint64_t a1;
      uint64_t a2;
      uint64_t a3;
      uint64_t a4;
      uint64_t o0;
      uint64_t o1;
      uint64_t o2;
      uint64_t o3;
      uint64_t o4;
      uint64_t *tmp112;
      uint64_t *tmp2;
      uint64_t *tmp3;
      uint64_t *tmp41;
      uint64_t *tmp51;
      uint64_t *tmp61;
      uint64_t t0;
      uint64_t t1;
      uint64_t t2;
      uint64_t t31;
      uint64_t t4;
      uint64_t t1_0;
      uint64_t t0_0;
      uint64_t t2_0;
      uint64_t t1__0;
      uint64_t t3_0;
      uint64_t t2__0;
      uint64_t t4_0;
      uint64_t t3__0;
      uint64_t i0;
      uint64_t i1;
      uint64_t i0_0;
      uint64_t i1_0;
      uint64_t *tmp11;
      uint64_t *tmp4;
      uint64_t *tmp5;
      uint64_t *tmp6;
      uint64_t *x3;
      uint64_t *y3;
      uint64_t *z3;
      uint64_t *t3;
      bool b;
      d2[0U] = (uint64_t)0x00069b9426b2f159U;
      d2[1U] = (uint64_t)0x00035050762add7aU;
      d2[2U] = (uint64_t)0x0003cf44c0038052U;
      d2[3U] = (uint64_t)0x0006738cc7407977U;
      d2[4U] = (uint64_t)0x0002406d9dc56dffU;
      Hacl_Bignum_fmul(tmp111, t11, d2);
      Hacl_Bignum_fmul(tmp21, tmp111, t21);
      a0 = z1[0U];
      a1 = z1[1U];
      a2 = z1[2U];
      a3 = z1[3U];
      a4 = z1[4U];
      o0 = (uint64_t)2U * a0;
      o1 = (uint64_t)2U * a1;
      o2 = (uint64_t)2U * a2;
      o3 = (uint64_t)2U * a3;
      o4 = (uint64_t)2U * a4;
      tmp111[0U] = o0;
      tmp111[1U] = o1;
      tmp111[2U] = o2;
      tmp111[3U] = o3;
      tmp111[4U] = o4;
      Hacl_Bignum_fmul(tmp50, tmp111, z2);
      memcpy(tmp111, tmp31, (uint32_t)5U * sizeof tmp31[0U]);
      memcpy(tmp60, tmp21, (uint32_t)5U * sizeof tmp21[0U]);
      tmp112 = tmp1;
      tmp2 = tmp1 + (uint32_t)5U;
      tmp3 = tmp1 + (uint32_t)10U;
      tmp41 = tmp1 + (uint32_t)15U;
      tmp51 = tmp1 + (uint32_t)20U;
      tmp61 = tmp1 + (uint32_t)25U;
      Hacl_Bignum_fdifference(tmp112, tmp41);
      t0 = tmp112[0U];
      t1 = tmp112[1U];
      t2 = tmp112[2U];
      t31 = tmp112[3U];
      t4 = tmp112[4U];
      t1_0 = t1 + (t0 >> (uint32_t)51U);
      t0_0 = t0 & (uint64_t)0x7ffffffffffffU;
      t2_0 = t2 + (t1_0 >> (uint32_t)51U);
      t1__0 = t1_0 & (uint64_t)0x7ffffffffffffU;
      t3_0 = t31 + (t2_0 >> (uint32_t)51U);
      t2__0 = t2_0 & (uint64_t)0x7ffffffffffffU;
      t4_0 = t4 + (t3_0 >> (uint32_t)51U);
      t3__0 = t3_0 & (uint64_t)0x7ffffffffffffU;
      tmp112[0U] = t0_0;
      tmp112[1U] = t1__0;
      tmp112[2U] = t2__0;
      tmp112[3U] = t3__0;
      tmp112[4U] = t4_0;
      Hacl_Bignum_Modulo_carry_top(tmp112);
      i0 = tmp112[0U];
      i1 = tmp112[1U];
      i0_0 = i0 & (uint64_t)0x7ffffffffffffU;
      i1_0 = i1 + (i0 >> (uint32_t)51U);
      tmp112[0U] = i0_0;
      tmp112[1U] = i1_0;
      Hacl_Bignum_fdifference(tmp61, tmp51);
      Hacl_Bignum_fsum(tmp51, tmp2);
      Hacl_Bignum_fsum(tmp41, tmp3);
      tmp11 = tmp1;
      tmp4 = tmp1 + (uint32_t)15U;
      tmp5 = tmp1 + (uint32_t)20U;
      tmp6 = tmp1 + (uint32_t)25U;
      x3 = Hacl_Impl_Ed25519_ExtPoint_getx(rhA);
      y3 = Hacl_Impl_Ed25519_ExtPoint_gety(rhA);
      z3 = Hacl_Impl_Ed25519_ExtPoint_getz(rhA);
      t3 = Hacl_Impl_Ed25519_ExtPoint_gett(rhA);
      Hacl_Bignum_fmul(x3, tmp11, tmp6);
      Hacl_Bignum_fmul(y3, tmp5, tmp4);
      Hacl_Bignum_fmul(t3, tmp11, tmp4);
      Hacl_Bignum_fmul(z3, tmp5, tmp6);
      b = Hacl_Impl_Ed25519_PointEqual_point_equal(sB, rhA);
      return b;
    }
  }
}

static void Hacl_SHA2_512_hash(uint8_t *hash1, uint8_t *input, uint32_t len1)
{
  Hacl_Impl_SHA2_512_hash(hash1, input, len1);
}

static void Hacl_Impl_Ed25519_SecretExpand_secret_expand(uint8_t *expanded, uint8_t *secret)
{
  uint8_t *h_low;
  uint8_t h_low0;
  uint8_t h_low31;
  Hacl_SHA2_512_hash(expanded, secret, (uint32_t)32U);
  h_low = expanded;
  h_low0 = h_low[0U];
  h_low31 = h_low[31U];
  h_low[0U] = h_low0 & (uint8_t)0xf8U;
  h_low[31U] = (h_low31 & (uint8_t)127U) | (uint8_t)64U;
}

static uint64_t Hacl_Impl_Ed25519_PointCompress_x_mod_2(uint64_t *x)
{
  uint64_t x0 = x[0U];
  return x0 & (uint64_t)1U;
}

static void Hacl_Impl_Ed25519_PointCompress_point_compress(uint8_t *z, uint64_t *p10)
{
  uint64_t tmp[15U] = { 0U };
  uint64_t *x = tmp + (uint32_t)5U;
  uint64_t *out = tmp + (uint32_t)10U;
  uint64_t *zinv1 = tmp;
  uint64_t *x1 = tmp + (uint32_t)5U;
  uint64_t *out1 = tmp + (uint32_t)10U;
  uint64_t *px = Hacl_Impl_Ed25519_ExtPoint_getx(p10);
  uint64_t *py = Hacl_Impl_Ed25519_ExtPoint_gety(p10);
  uint64_t *pz = Hacl_Impl_Ed25519_ExtPoint_getz(p10);
  uint64_t b;
  uint8_t xbyte;
  uint8_t o31;
  Hacl_Bignum_Crecip_crecip(zinv1, pz);
  Hacl_Bignum_fmul(x1, px, zinv1);
  Hacl_EC_Format_reduce(x1);
  Hacl_Bignum_fmul(out1, py, zinv1);
  Hacl_EC_Format_reduce(out1);
  b = Hacl_Impl_Ed25519_PointCompress_x_mod_2(x);
  Hacl_EC_Format_fcontract_store(z, out);
  xbyte = (uint8_t)b;
  o31 = z[31U];
  z[31U] = o31 + (xbyte << (uint32_t)7U);
}

static void Hacl_Impl_Ed25519_Sign_Steps_sign_step_3(uint8_t *tmp_bytes, uint64_t *tmp_ints)
{
  uint8_t rb[32U] = { 0U };
  uint64_t *r = tmp_ints + (uint32_t)20U;
  uint8_t *rs_ = tmp_bytes + (uint32_t)160U;
  Hacl_Impl_Store56_store_56(rb, r);
  {
    uint64_t tmp[20U] = { 0U };
    uint64_t g1[20U] = { 0U };
    uint64_t *gx = Hacl_Impl_Ed25519_ExtPoint_getx(g1);
    uint64_t *gy = Hacl_Impl_Ed25519_ExtPoint_gety(g1);
    uint64_t *gz = Hacl_Impl_Ed25519_ExtPoint_getz(g1);
    uint64_t *gt1 = Hacl_Impl_Ed25519_ExtPoint_gett(g1);
    gx[0U] = (uint64_t)0x00062d608f25d51aU;
    gx[1U] = (uint64_t)0x000412a4b4f6592aU;
    gx[2U] = (uint64_t)0x00075b7171a4b31dU;
    gx[3U] = (uint64_t)0x0001ff60527118feU;
    gx[4U] = (uint64_t)0x000216936d3cd6e5U;
    gy[0U] = (uint64_t)0x0006666666666658U;
    gy[1U] = (uint64_t)0x0004ccccccccccccU;
    gy[2U] = (uint64_t)0x0001999999999999U;
    gy[3U] = (uint64_t)0x0003333333333333U;
    gy[4U] = (uint64_t)0x0006666666666666U;
    gz[0U] = (uint64_t)0x0000000000000001U;
    gz[1U] = (uint64_t)0x0000000000000000U;
    gz[2U] = (uint64_t)0x0000000000000000U;
    gz[3U] = (uint64_t)0x0000000000000000U;
    gz[4U] = (uint64_t)0x0000000000000000U;
    gt1[0U] = (uint64_t)0x00068ab3a5b7dda3U;
    gt1[1U] = (uint64_t)0x00000eea2a5eadbbU;
    gt1[2U] = (uint64_t)0x0002af8df483c27eU;
    gt1[3U] = (uint64_t)0x000332b375274732U;
    gt1[4U] = (uint64_t)0x00067875f0fd78b7U;
    Hacl_Impl_Ed25519_Ladder_point_mul(tmp, rb, g1);
    Hacl_Impl_Ed25519_PointCompress_point_compress(rs_, tmp);
  }
}

static void Hacl_Impl_Ed25519_Sign_Steps_sign_step_5(uint8_t *tmp_bytes, uint64_t *tmp_ints)
{
  uint64_t *r = tmp_ints + (uint32_t)20U;
  uint64_t *aq = tmp_ints + (uint32_t)45U;
  uint64_t *ha = tmp_ints + (uint32_t)50U;
  uint64_t *s = tmp_ints + (uint32_t)55U;
  uint64_t *h = tmp_ints + (uint32_t)60U;
  uint8_t *s_ = tmp_bytes + (uint32_t)192U;
  uint8_t *a = tmp_bytes + (uint32_t)224U;
  Hacl_Impl_Load56_load_32_bytes(aq, a);
  Hacl_Impl_BignumQ_Mul_mul_modq(ha, h, aq);
  Hacl_Impl_BignumQ_Mul_add_modq(s, r, ha);
  Hacl_Impl_Store56_store_56(s_, s);
}

void Hacl_Ed25519_sign(uint8_t *signature, uint8_t *secret, uint8_t *msg, uint32_t len1)
{
  uint8_t tmp_bytes[352U] = { 0U };
  uint64_t tmp_ints[65U] = { 0U };
  uint8_t *rs_ = tmp_bytes + (uint32_t)160U;
  uint8_t *s_ = tmp_bytes + (uint32_t)192U;
  uint8_t *a__ = tmp_bytes + (uint32_t)96U;
  uint8_t *apre0 = tmp_bytes + (uint32_t)224U;
  uint8_t *a = apre0;
  Hacl_Impl_Ed25519_SecretExpand_secret_expand(apre0, secret);
  {
    uint64_t tmp[20U] = { 0U };
    uint64_t g1[20U] = { 0U };
    uint64_t *gx = Hacl_Impl_Ed25519_ExtPoint_getx(g1);
    uint64_t *gy = Hacl_Impl_Ed25519_ExtPoint_gety(g1);
    uint64_t *gz = Hacl_Impl_Ed25519_ExtPoint_getz(g1);
    uint64_t *gt1 = Hacl_Impl_Ed25519_ExtPoint_gett(g1);
    uint64_t *r1;
    uint8_t *apre;
    uint8_t *prefix;
    uint64_t *h4;
    uint8_t *a__0;
    uint8_t *rs_1;
    gx[0U] = (uint64_t)0x00062d608f25d51aU;
    gx[1U] = (uint64_t)0x000412a4b4f6592aU;
    gx[2U] = (uint64_t)0x00075b7171a4b31dU;
    gx[3U] = (uint64_t)0x0001ff60527118feU;
    gx[4U] = (uint64_t)0x000216936d3cd6e5U;
    gy[0U] = (uint64_t)0x0006666666666658U;
    gy[1U] = (uint64_t)0x0004ccccccccccccU;
    gy[2U] = (uint64_t)0x0001999999999999U;
    gy[3U] = (uint64_t)0x0003333333333333U;
    gy[4U] = (uint64_t)0x0006666666666666U;
    gz[0U] = (uint64_t)0x0000000000000001U;
    gz[1U] = (uint64_t)0x0000000000000000U;
    gz[2U] = (uint64_t)0x0000000000000000U;
    gz[3U] = (uint64_t)0x0000000000000000U;
    gz[4U] = (uint64_t)0x0000000000000000U;
    gt1[0U] = (uint64_t)0x00068ab3a5b7dda3U;
    gt1[1U] = (uint64_t)0x00000eea2a5eadbbU;
    gt1[2U] = (uint64_t)0x0002af8df483c27eU;
    gt1[3U] = (uint64_t)0x000332b375274732U;
    gt1[4U] = (uint64_t)0x00067875f0fd78b7U;
    Hacl_Impl_Ed25519_Ladder_point_mul(tmp, a, g1);
    Hacl_Impl_Ed25519_PointCompress_point_compress(a__, tmp);
    r1 = tmp_ints + (uint32_t)20U;
    apre = tmp_bytes + (uint32_t)224U;
    prefix = apre + (uint32_t)32U;
    Hacl_Impl_SHA512_ModQ_sha512_modq_pre(r1, prefix, msg, len1);
    Hacl_Impl_Ed25519_Sign_Steps_sign_step_3(tmp_bytes, tmp_ints);
    h4 = tmp_ints + (uint32_t)60U;
    a__0 = tmp_bytes + (uint32_t)96U;
    rs_1 = tmp_bytes + (uint32_t)160U;
    Hacl_Impl_SHA512_ModQ_sha512_modq_pre_pre2(h4, rs_1, a__0, msg, len1);
    Hacl_Impl_Ed25519_Sign_Steps_sign_step_5(tmp_bytes, tmp_ints);
    memcpy(signature, rs_, (uint32_t)32U * sizeof rs_[0U]);
    memcpy(signature + (uint32_t)32U, s_, (uint32_t)32U * sizeof s_[0U]);
  }
}

bool Hacl_Ed25519_verify(uint8_t *output, uint8_t *msg, uint32_t len1, uint8_t *signature)
{
  uint64_t tmp[45U] = { 0U };
  uint8_t tmp_[32U] = { 0U };
  uint64_t *a_ = tmp;
  uint64_t *r_ = tmp + (uint32_t)20U;
  uint64_t *s = tmp + (uint32_t)40U;
  uint8_t *h_ = tmp_;
  bool b = Hacl_Impl_Ed25519_PointDecompress_point_decompress(a_, output);
  bool res;
  if (b)
  {
    uint8_t *rs = signature;
    bool b_ = Hacl_Impl_Ed25519_Verify_Steps_verify_step_1(r_, signature);
    bool ite0;
    if (b_)
    {
      Hacl_Impl_Load56_load_32_bytes(s, signature + (uint32_t)32U);
      {
        bool b__ = Hacl_Impl_Ed25519_PointEqual_gte_q(s);
        bool ite;
        if (b__)
        {
          ite = false;
        }
        else
        {
          Hacl_Impl_Ed25519_Verify_Steps_verify_step_2(h_, msg, len1, rs, output);
          {
            bool
            b1 = Hacl_Impl_Ed25519_Verify_Steps_verify_step_4(signature + (uint32_t)32U, h_, a_, r_);
            ite = b1;
          }
        }
        ite0 = ite;
      }
    }
    else
    {
      ite0 = false;
    }
    res = ite0;
  }
  else
  {
    res = false;
  }
  {
    bool res0 = res;
    return res0;
  }
}

void Hacl_Ed25519_secret_to_public(uint8_t *output, uint8_t *secret)
{
  uint8_t expanded[64U] = { 0U };
  uint8_t *a;
  Hacl_Impl_Ed25519_SecretExpand_secret_expand(expanded, secret);
  a = expanded;
  {
    uint64_t res[20U] = { 0U };
    uint64_t g1[20U] = { 0U };
    uint64_t *gx = Hacl_Impl_Ed25519_ExtPoint_getx(g1);
    uint64_t *gy = Hacl_Impl_Ed25519_ExtPoint_gety(g1);
    uint64_t *gz = Hacl_Impl_Ed25519_ExtPoint_getz(g1);
    uint64_t *gt1 = Hacl_Impl_Ed25519_ExtPoint_gett(g1);
    gx[0U] = (uint64_t)0x00062d608f25d51aU;
    gx[1U] = (uint64_t)0x000412a4b4f6592aU;
    gx[2U] = (uint64_t)0x00075b7171a4b31dU;
    gx[3U] = (uint64_t)0x0001ff60527118feU;
    gx[4U] = (uint64_t)0x000216936d3cd6e5U;
    gy[0U] = (uint64_t)0x0006666666666658U;
    gy[1U] = (uint64_t)0x0004ccccccccccccU;
    gy[2U] = (uint64_t)0x0001999999999999U;
    gy[3U] = (uint64_t)0x0003333333333333U;
    gy[4U] = (uint64_t)0x0006666666666666U;
    gz[0U] = (uint64_t)0x0000000000000001U;
    gz[1U] = (uint64_t)0x0000000000000000U;
    gz[2U] = (uint64_t)0x0000000000000000U;
    gz[3U] = (uint64_t)0x0000000000000000U;
    gz[4U] = (uint64_t)0x0000000000000000U;
    gt1[0U] = (uint64_t)0x00068ab3a5b7dda3U;
    gt1[1U] = (uint64_t)0x00000eea2a5eadbbU;
    gt1[2U] = (uint64_t)0x0002af8df483c27eU;
    gt1[3U] = (uint64_t)0x000332b375274732U;
    gt1[4U] = (uint64_t)0x00067875f0fd78b7U;
    Hacl_Impl_Ed25519_Ladder_point_mul(res, a, g1);
    Hacl_Impl_Ed25519_PointCompress_point_compress(output, res);
  }
}

void Hacl_Ed25519_expand_keys(uint8_t *ks, uint8_t *secret)
{
  Hacl_Impl_Ed25519_SecretExpand_secret_expand(ks + (uint32_t)32U, secret);
  {
    uint8_t expanded[64U] = { 0U };
    uint8_t *a;
    Hacl_Impl_Ed25519_SecretExpand_secret_expand(expanded, secret);
    a = expanded;
    {
      uint64_t res[20U] = { 0U };
      uint64_t g1[20U] = { 0U };
      uint64_t *gx = Hacl_Impl_Ed25519_ExtPoint_getx(g1);
      uint64_t *gy = Hacl_Impl_Ed25519_ExtPoint_gety(g1);
      uint64_t *gz = Hacl_Impl_Ed25519_ExtPoint_getz(g1);
      uint64_t *gt1 = Hacl_Impl_Ed25519_ExtPoint_gett(g1);
      gx[0U] = (uint64_t)0x00062d608f25d51aU;
      gx[1U] = (uint64_t)0x000412a4b4f6592aU;
      gx[2U] = (uint64_t)0x00075b7171a4b31dU;
      gx[3U] = (uint64_t)0x0001ff60527118feU;
      gx[4U] = (uint64_t)0x000216936d3cd6e5U;
      gy[0U] = (uint64_t)0x0006666666666658U;
      gy[1U] = (uint64_t)0x0004ccccccccccccU;
      gy[2U] = (uint64_t)0x0001999999999999U;
      gy[3U] = (uint64_t)0x0003333333333333U;
      gy[4U] = (uint64_t)0x0006666666666666U;
      gz[0U] = (uint64_t)0x0000000000000001U;
      gz[1U] = (uint64_t)0x0000000000000000U;
      gz[2U] = (uint64_t)0x0000000000000000U;
      gz[3U] = (uint64_t)0x0000000000000000U;
      gz[4U] = (uint64_t)0x0000000000000000U;
      gt1[0U] = (uint64_t)0x00068ab3a5b7dda3U;
      gt1[1U] = (uint64_t)0x00000eea2a5eadbbU;
      gt1[2U] = (uint64_t)0x0002af8df483c27eU;
      gt1[3U] = (uint64_t)0x000332b375274732U;
      gt1[4U] = (uint64_t)0x00067875f0fd78b7U;
      Hacl_Impl_Ed25519_Ladder_point_mul(res, a, g1);
      Hacl_Impl_Ed25519_PointCompress_point_compress(ks, res);
    }
  }
}

void Hacl_Ed25519_sign_expanded(uint8_t *signature, uint8_t *ks, uint8_t *msg, uint32_t len1)
{
  uint8_t tmp_bytes[352U] = { 0U };
  uint64_t tmp_ints[65U] = { 0U };
  uint8_t *rs_ = tmp_bytes + (uint32_t)160U;
  uint8_t *s_ = tmp_bytes + (uint32_t)192U;
  uint8_t *tmp_public = tmp_bytes + (uint32_t)96U;
  uint8_t *tmp_xsecret = tmp_bytes + (uint32_t)224U;
  uint64_t *r1;
  uint8_t *apre;
  uint8_t *prefix;
  uint64_t *h4;
  uint8_t *a__;
  uint8_t *rs_1;
  memcpy(tmp_public, ks, (uint32_t)32U * sizeof ks[0U]);
  memcpy(tmp_xsecret, ks + (uint32_t)32U, (uint32_t)64U * sizeof (ks + (uint32_t)32U)[0U]);
  r1 = tmp_ints + (uint32_t)20U;
  apre = tmp_bytes + (uint32_t)224U;
  prefix = apre + (uint32_t)32U;
  Hacl_Impl_SHA512_ModQ_sha512_modq_pre(r1, prefix, msg, len1);
  Hacl_Impl_Ed25519_Sign_Steps_sign_step_3(tmp_bytes, tmp_ints);
  h4 = tmp_ints + (uint32_t)60U;
  a__ = tmp_bytes + (uint32_t)96U;
  rs_1 = tmp_bytes + (uint32_t)160U;
  Hacl_Impl_SHA512_ModQ_sha512_modq_pre_pre2(h4, rs_1, a__, msg, len1);
  Hacl_Impl_Ed25519_Sign_Steps_sign_step_5(tmp_bytes, tmp_ints);
  memcpy(signature, rs_, (uint32_t)32U * sizeof rs_[0U]);
  memcpy(signature + (uint32_t)32U, s_, (uint32_t)32U * sizeof s_[0U]);
}

